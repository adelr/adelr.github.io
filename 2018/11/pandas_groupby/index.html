<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Pandas (Blood)groupby - Dinkum Data Blog</title>
  <meta property="og:title" content="Pandas (Blood)groupby" />
  <meta name="twitter:title" content="Pandas (Blood)groupby" />
  <meta name="description" content="An introduction to groupby operations in pandas">
  <meta property="og:description" content="An introduction to groupby operations in pandas">
  <meta name="twitter:description" content="An introduction to groupby operations in pandas">
  <meta name="author" content="Adel Rahmani"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Dinkum Data Blog",
    
    "url": "https:\/\/adelr.github.io\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/adelr.github.io\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/adelr.github.io\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/adelr.github.io\/2018\/11\/pandas_groupby\/",
          "name": "Pandas ( blood)groupby"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Adel Rahmani"
  },
  "headline": "Pandas (Blood)groupby",
  "description" : "An introduction to groupby operations in pandas",
  "inLanguage" : "en",
  "wordCount":  7831 ,
  "datePublished" : "2018-11-15T00:00:00",
  "dateModified" : "2018-11-15T00:00:00",
  "image" : "https:\/\/adelr.github.io\/img\/avatar-icon.png",
  "keywords" : [ "python, pandas, groupby, data wrangling" ],
  "mainEntityOfPage" : "https:\/\/adelr.github.io\/2018\/11\/pandas_groupby\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/adelr.github.io\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/adelr.github.io\/img\/avatar-icon.png",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Pandas (Blood)groupby" />
<meta property="og:description" content="An introduction to groupby operations in pandas">
<meta property="og:image" content="https://adelr.github.io/img/avatar-icon.png" />
<meta property="og:url" content="https://adelr.github.io/2018/11/pandas_groupby/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Dinkum Data Blog" />

  <meta name="twitter:title" content="Pandas (Blood)groupby" />
  <meta name="twitter:description" content="An introduction to groupby operations in pandas">
  <meta name="twitter:image" content="https://adelr.github.io/img/avatar-icon.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@DinkumData" />
  <meta name="twitter:creator" content="@DinkumData" />
  <meta property="og:image" content="https://adelr.github.io/img/avatar-icon.png" />
  <meta name="twitter:image" content="https://adelr.github.io/img/avatar-icon.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@DinkumData" />
  <meta name="twitter:creator" content="@DinkumData" />
  <meta property="og:url" content="https://adelr.github.io/2018/11/pandas_groupby/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Dinkum Data Blog" />

  <meta name="generator" content="Hugo 0.55.6" />
  <link rel="alternate" href="https://adelr.github.io/index.xml" type="application/rss+xml" title="Dinkum Data Blog"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><link rel="stylesheet" href="https://adelr.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="https://adelr.github.io/css/highlight.min.css" /><link rel="stylesheet" href="https://adelr.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-96102728-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://adelr.github.io/">Dinkum Data Blog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="Dinkum Data Blog" href="https://adelr.github.io/">
            <img class="avatar-img" src="https://adelr.github.io/img/avatar-icon.png" alt="Dinkum Data Blog" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              
                <h1>Pandas (Blood)groupby</h1>
              
              
              
              
                <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on November 15, 2018
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;37&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;7831&nbsp;words
  
  
    &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Adel Rahmani
  
  
</span>


              
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        

<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&#34;&lt;style&gt;.container { width:100% !important; }&lt;/style&gt;&#34;</span><span class="p">))</span></code></pre></div>
<style>.container { width:100% !important; }</style>

<h2 id="1-pandas-groupby">1. Pandas GroupBy</h2>

<p>To illustrate how the pandas <code>groupby</code> operation works let&rsquo;s use some fake data. With <code>numpy</code> it&rsquo;s trivial to generate random numerical data, however, it&rsquo;s usually a lot more tedious to generate random people data that looks realistic.</p>

<p>A very useful tool for this is the <a href="http://www.fakenamegenerator.com/">Fake Name Generator</a>. That&rsquo;s what I used to generate
this dataset.</p>

<p>Let&rsquo;s load the dataset into a dataframe.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">input_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;data/people.csv&#39;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GivenName</th>
      <th>Surname</th>
      <th>Gender</th>
      <th>StreetAddress</th>
      <th>City</th>
      <th>Country</th>
      <th>Birthday</th>
      <th>BloodType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stepanida</td>
      <td>Sukhorukova</td>
      <td>female</td>
      <td>62 Ockham Road</td>
      <td>EASTER WHYNTIE</td>
      <td>United Kingdom</td>
      <td>8/25/1968</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Hiệu</td>
      <td>Lương</td>
      <td>male</td>
      <td>4 Iolaire Road</td>
      <td>NEW CROSS</td>
      <td>United Kingdom</td>
      <td>1/31/1962</td>
      <td>A+</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Petra</td>
      <td>Neudorf</td>
      <td>female</td>
      <td>56 Victoria Road</td>
      <td>LISTON</td>
      <td>United Kingdom</td>
      <td>1/10/1964</td>
      <td>B+</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Eho</td>
      <td>Amano</td>
      <td>female</td>
      <td>83 Stroud Rd</td>
      <td>OGMORE</td>
      <td>United Kingdom</td>
      <td>4/12/1933</td>
      <td>O-</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Noah</td>
      <td>Niland</td>
      <td>male</td>
      <td>61 Wrexham Rd</td>
      <td>FACEBY</td>
      <td>United Kingdom</td>
      <td>11/20/1946</td>
      <td>A+</td>
    </tr>
  </tbody>
</table>
</div>

<p>The data contains information about fictitious people.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">()</span></code></pre></div><div class="highlight"><pre class="chroma">GivenName        5000
Surname          5000
Gender           5000
StreetAddress    5000
City             5000
Country          5000
Birthday         5000
BloodType        5000
dtype: int64</pre></div>
<div style="background-color:#F7F2E0;">
<h4> <font color=MediumVioletRed>Remark:</font> </h4>
<p>We've got different types of variables here. For instance, <code>Gender</code> is a categorical variable, so are <code>BloodType</code> and <code>Country</code>. </p>
<p><code>Birthday</code> can be thought of as an interval variable, although we'll convert it to an <code>Age</code> variable, which is more convenient for our purpose, and will be treated as a continuous numeric variable. </p>
<p>Notice, however, that by default pandas will identify non-numeric data as a generic object, which is not the most efficient way of handling categorical data. Let's fix that.</p>
</div>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span></code></pre></div><div class="highlight"><pre class="chroma">GivenName        object
Surname          object
Gender           object
StreetAddress    object
City             object
Country          object
Birthday         object
BloodType        object
dtype: object</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;BloodType&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;BloodType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">dtypes</span></code></pre></div><div class="highlight"><pre class="chroma">GivenName          object
Surname            object
Gender           category
StreetAddress      object
City               object
Country          category
Birthday           object
BloodType        category
dtype: object</pre></div>
<h3> <center><font color=MediumVioletRed>A. Dealing with dates.</font></center></h3>

<h4>Method 1 - <code>datetime</code> module.</h4>

<p>One of the features (columns) in our dataset is <code>Birthday</code>. While this information may be useful if you wanted to
find out, for instance, how many people share a birthday, most of the time we mainly care about their age.</p>

<p>One way to convert the <code>Birthday</code> into an <code>Age</code> feature would be to extract the year and compute the current year minus
the birthday year. The <code>split</code> method of string objects could be used for that, however, there&rsquo;s a more elegant, and general
way of handling dates in Python using the <a href="https://pymotw.com/3/datetime/"><code>datetime.strptime</code> function</a>.</p>

<div style="background-color:#F7F2E0;">
<h3> <font color=MediumVioletRed>Remark:</font> </h3>
<p>This isn't necessarily the fastest, or best way to handle date and time objects in <code>pandas</code>. </p>
</div>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s2">&#34;21/01/2019&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="si">%d</span><span class="s2">/%m/%Y&#34;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">-</span><span class="n">t1</span><span class="p">)</span></code></pre></div><div class="highlight"><pre class="chroma">2019
62 days, 20:14:58.495945</pre></div>
<p>The <code>datetime</code> module allows you to manipulate date objects and perform basic <strong>operations on dates</strong>. It also allows you to
format dates in a consistent way.</p>

<p>We can apply this to our <code>Birthday</code> feature.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">Birthday</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="o">.</span><span class="n">Birthday</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code></pre></div><div class="highlight"><pre class="chroma">(&#39;8/25/1968&#39;, &#39;1/31/1962&#39;)</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Birthday</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">&#34;%m/</span><span class="si">%d</span><span class="s2">/%Y&#34;</span><span class="p">)</span></code></pre></div><div class="highlight"><pre class="chroma">datetime.datetime(1968, 8, 25, 0, 0)</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Birthday</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s2">&#34;%m/</span><span class="si">%d</span><span class="s2">/%Y&#34;</span><span class="p">)</span></code></pre></div><div class="highlight"><pre class="chroma">datetime.datetime(1962, 1, 31, 0, 0)</pre></div>
<h4 id="let-s-use-the-pandas-apply-method-to-format-the-dates-in-a-consistent-way">Let&rsquo;s use the Pandas <code>apply</code> method to format the dates in a consistent way</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">Birthday</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Birthday&#39;</span><span class="p">],</span> <span class="s2">&#34;%m/</span><span class="si">%d</span><span class="s2">/%Y&#34;</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">Birthday</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div><div class="highlight"><pre class="chroma">0   1968-08-25
1   1962-01-31
2   1964-01-10
3   1933-04-12
4   1946-11-20
Name: Birthday, dtype: datetime64[ns]</pre></div>
<h4>Method 2 - using the <code>to_datetime</code> method of pandas.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">original_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
<span class="n">original_data</span><span class="o">.</span><span class="n">Birthday</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">original_data</span><span class="o">.</span><span class="n">Birthday</span><span class="p">)</span>
<span class="n">original_data</span><span class="o">.</span><span class="n">Birthday</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div><div class="highlight"><pre class="chroma">0   1968-08-25
1   1962-01-31
2   1964-01-10
3   1933-04-12
4   1946-11-20
Name: Birthday, dtype: datetime64[ns]</pre></div>
<h4>Method 3 - convert at reading time.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">original_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Birthday&#39;</span><span class="p">])</span>
<span class="n">original_data</span><span class="o">.</span><span class="n">Birthday</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div><div class="highlight"><pre class="chroma">0   1968-08-25
1   1962-01-31
2   1964-01-10
3   1933-04-12
4   1946-11-20
Name: Birthday, dtype: datetime64[ns]</pre></div>
<h4>We can now define an <code>Age</code> feature by subtracting the year of birth from the current year.</h4> 

<div style="background-color:#F7F2E0;">
<h3> <font color=MediumVioletRed>Remark:</font> </h3>
<p>Because we are not hard-coding (typing by hand) the current date, if we come back to this code in a year's time and run it again,
    the <code>Age</code> will be updated automatically. </p>
</div>

<h4 id="we-could-compute-the-age-using-code-apply-code-to-iterate-through-the-rows-of-the-dataframe">We could compute the age using <code>apply</code> to iterate through the rows of the dataframe&hellip;</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Birthday&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div><div class="highlight"><pre class="chroma">0    51
1    57
2    55
3    86
4    73
dtype: int64</pre></div>
<h4>However, it is usually faster to operate on the whole dataframe at one.</h4>

<p>Datetime methods on a pandas series (such as a column of a dataframe), can be accessed via the <code>dt</code> method.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">Birthday</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div><div class="highlight"><pre class="chroma">0    51
1    57
2    55
3    86
4    73
Name: Birthday, dtype: int64</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">year</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">Birthday</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GivenName</th>
      <th>Surname</th>
      <th>Gender</th>
      <th>StreetAddress</th>
      <th>City</th>
      <th>Country</th>
      <th>Birthday</th>
      <th>BloodType</th>
      <th>Age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Stepanida</td>
      <td>Sukhorukova</td>
      <td>female</td>
      <td>62 Ockham Road</td>
      <td>EASTER WHYNTIE</td>
      <td>United Kingdom</td>
      <td>1968-08-25</td>
      <td>A+</td>
      <td>51</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Hiệu</td>
      <td>Lương</td>
      <td>male</td>
      <td>4 Iolaire Road</td>
      <td>NEW CROSS</td>
      <td>United Kingdom</td>
      <td>1962-01-31</td>
      <td>A+</td>
      <td>57</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Petra</td>
      <td>Neudorf</td>
      <td>female</td>
      <td>56 Victoria Road</td>
      <td>LISTON</td>
      <td>United Kingdom</td>
      <td>1964-01-10</td>
      <td>B+</td>
      <td>55</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Eho</td>
      <td>Amano</td>
      <td>female</td>
      <td>83 Stroud Rd</td>
      <td>OGMORE</td>
      <td>United Kingdom</td>
      <td>1933-04-12</td>
      <td>O-</td>
      <td>86</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Noah</td>
      <td>Niland</td>
      <td>male</td>
      <td>61 Wrexham Rd</td>
      <td>FACEBY</td>
      <td>United Kingdom</td>
      <td>1946-11-20</td>
      <td>A+</td>
      <td>73</td>
    </tr>
  </tbody>
</table>
</div>

<h3> <center><font color=MediumVioletRed>B. GroupBy feature.</font></center></h3>

<p>Given the data, common questions to answer would be how certain features are distributed in each
country, or for each gender.</p>

<p>These could be as simple as <strong>What is the average age in each country?</strong>
to much more complex questions such as <strong>How many people of each blood type are there in each country, for
each gender, for a given age group?</strong></p>

<p>Fortunately, Pandas&rsquo; <code>GroupBy</code> method allows us to organise the data in ways only limited by our sagacity.</p>

<h4> Let's look at the country distribution first.  </h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">Country</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span></code></pre></div><div class="highlight"><pre class="chroma">Australia         1800
Italy              800
United States      700
United Kingdom     500
New Zealand        500
France             500
Iceland            200
Name: Country, dtype: int64</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">Country</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;barh&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span></code></pre></div>
<p><img src="output_31_0.png" alt="png" /></p>

<h4 id="the-groupby-method-creates-a-groupby-object">The <code>groupby</code> method creates a <code>GroupBy</code> object.</h4>

<p>The <code>groupby</code> object is a recipe for how to perform operation on the data.</p>

<p>To use a <code>groupby</code> object, we need to perform some operation on it.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)</span>
<span class="n">grouped_by_country</span></code></pre></div><div class="highlight"><pre class="chroma">&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x106ca5710&gt;</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country</span><span class="o">.</span><span class="n">size</span><span class="p">()</span></code></pre></div><div class="highlight"><pre class="chroma">Country
Australia         1800
France             500
Iceland            200
Italy              800
New Zealand        500
United Kingdom     500
United States      700
dtype: int64</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country</span><span class="o">.</span><span class="n">ngroups</span></code></pre></div><div class="highlight"><pre class="chroma">7</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped_by_country</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">group</span><span class="p">)</span></code></pre></div><div class="highlight"><pre class="chroma">Australia
France
Iceland
Italy
New Zealand
United Kingdom
United States</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span></code></pre></div><div class="highlight"><pre class="chroma">Country
Australia         57.817778
France            57.944000
Iceland           57.660000
Italy             56.607500
New Zealand       56.630000
United Kingdom    57.740000
United States     57.415714
Name: Age, dtype: float64</pre></div>
<div style="background-color:#F7F2E0;">
<h3> <font color=MediumVioletRed>Remark:</font> </h3>
<p>Recall that the <code>apply</code> method allows you to apply an <b>arbitrary function</b> to all the rows in your dataframe. Therefore, as long as you can express your operations as a function (lambda or otherwise), you can include it in the <code>apply</code>, <b>even if your function returns multiple values</b>, provided you wrap them in a tuple.</p>
</div>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> 
                                           <span class="n">f</span><span class="s1">&#39;{x.mean():0.2f}&#39;</span><span class="p">,</span> 
                                           <span class="n">np</span><span class="o">.</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> 
                                           <span class="n">f</span><span class="s1">&#39;{x.std():0.2f}&#39;</span><span class="p">)</span>
                                <span class="p">)</span></code></pre></div><div class="highlight"><pre class="chroma">Country
Australia         (24, 57.82, 91, 19.49)
France            (24, 57.94, 91, 19.54)
Iceland           (24, 57.66, 91, 19.46)
Italy             (24, 56.61, 91, 18.98)
New Zealand       (24, 56.63, 91, 19.05)
United Kingdom    (24, 57.74, 91, 19.53)
United States     (24, 57.42, 91, 19.29)
Name: Age, dtype: object</pre></div>
<h4 id="a-different-and-nicer-output-can-be-obtained-using-the-agg-method-on-a-groupby-object">A different and nicer output can be obtained using the <code>agg</code> method on a groupby object.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">])</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>mean</th>
      <th>max</th>
      <th>std</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>24</td>
      <td>57.817778</td>
      <td>91</td>
      <td>19.488031</td>
    </tr>
    <tr>
      <th>France</th>
      <td>24</td>
      <td>57.944000</td>
      <td>91</td>
      <td>19.541869</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>24</td>
      <td>57.660000</td>
      <td>91</td>
      <td>19.461194</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>24</td>
      <td>56.607500</td>
      <td>91</td>
      <td>18.981275</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>24</td>
      <td>56.630000</td>
      <td>91</td>
      <td>19.049905</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>24</td>
      <td>57.740000</td>
      <td>91</td>
      <td>19.527905</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>24</td>
      <td>57.415714</td>
      <td>91</td>
      <td>19.285003</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="for-categorical-variables-such-as-bloodtype-basic-information-can-be-extracted-using-the-describe-method">For categorical variables, such as <code>BloodType</code>, basic information can be extracted using the <code>describe</code> method.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country</span><span class="p">[</span><span class="s1">&#39;BloodType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>1800</td>
      <td>8</td>
      <td>O+</td>
      <td>648</td>
    </tr>
    <tr>
      <th>France</th>
      <td>500</td>
      <td>8</td>
      <td>O+</td>
      <td>184</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>200</td>
      <td>7</td>
      <td>O+</td>
      <td>86</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>800</td>
      <td>8</td>
      <td>O+</td>
      <td>299</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>500</td>
      <td>8</td>
      <td>O+</td>
      <td>185</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>500</td>
      <td>8</td>
      <td>O+</td>
      <td>188</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>700</td>
      <td>8</td>
      <td>O+</td>
      <td>273</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country</span><span class="p">[</span><span class="s1">&#39;GivenName&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>unique</th>
      <th>top</th>
      <th>freq</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>1800</td>
      <td>1368</td>
      <td>Michael</td>
      <td>9</td>
    </tr>
    <tr>
      <th>France</th>
      <td>500</td>
      <td>444</td>
      <td>Anna</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>200</td>
      <td>193</td>
      <td>Dieter</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>800</td>
      <td>677</td>
      <td>Jennifer</td>
      <td>6</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>500</td>
      <td>447</td>
      <td>James</td>
      <td>4</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>500</td>
      <td>450</td>
      <td>Ellis</td>
      <td>3</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>700</td>
      <td>620</td>
      <td>Lily</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>

<p><code>describe</code> only tells us about the most frequent blood type. To get a count of the boodtypes let us use a <code>Counter</code> object.</p>

<div style="background-color:#FBEFFB;">
<h4>Which item appears most frequently?</h4>

Counting the number of objects of a given type is such a common operation that Python has a very useful <code>Counter</code> object
from the <code>collections</code> module. 

What a <code>Counter</code> object does to a sequence of items is group the elements of the sequence into bins according to their value, and count how many element each bin has. A <code>Counter</code> object also had several useful properties, for instance, to determine the most common object in the sequence.
</div>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="n">c</span></code></pre></div><div class="highlight"><pre class="chroma">Counter({&#39;a&#39;: 3, &#39;b&#39;: 5, &#39;c&#39;: 2})</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">most_common</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span></code></pre></div><div class="highlight"><pre class="chroma">[(&#39;b&#39;, 5), (&#39;a&#39;, 3), (&#39;c&#39;, 2)]
[(&#39;b&#39;, 5), (&#39;a&#39;, 3)]
[(&#39;b&#39;, 5)]</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country</span><span class="p">[</span><span class="s1">&#39;BloodType&#39;</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span></code></pre></div><div class="highlight"><pre class="chroma">Country            
Australia       A+     468.0
                A-      59.0
                AB+    100.0
                AB-      8.0
                B+     419.0
                B-      24.0
                O+     648.0
                O-      74.0
France          A+     145.0
                A-      17.0
                AB+     19.0
                AB-      1.0
                B+     106.0
                B-       4.0
                O+     184.0
                O-      24.0
Iceland         A+      45.0
                A-       6.0
                AB+      5.0
                B+      44.0
                B-       5.0
                O+      86.0
                O-       9.0
Italy           A+     207.0
                A-      31.0
                AB+     37.0
                AB-      5.0
                B+     185.0
                B-       4.0
                O+     299.0
                O-      32.0
New Zealand     A+     154.0
                A-       9.0
                AB+     21.0
                AB-      5.0
                B+     100.0
                B-       5.0
                O+     185.0
                O-      21.0
United Kingdom  A+     132.0
                A-      23.0
                AB+     25.0
                AB-      4.0
                B+     102.0
                B-       7.0
                O+     188.0
                O-      19.0
United States   A+     157.0
                A-      25.0
                AB+     35.0
                AB-      4.0
                B+     157.0
                B-      15.0
                O+     273.0
                O-      34.0
Name: BloodType, dtype: float64</pre></div>
<div style="background-color:#F7F2E0;">
<h3> <font color=MediumVioletRed>Remark:</font> </h3>
<p>Note how the result is one long column of information. This result is actually a Pandas <code>Series</code> object (recall that a <code>Series</code> object is essentially an array with an index).</p>

<p>It may look a bit like a dataframe, but remember that in a dataframe each column corresponds to a <b>unique</b> feature. Here, what looks like the second column is actually a second level for the index. We'll talk about multi-index shortly.  </p>
<p>The result as it stands may not be the easiest to read. It would be better if we could transform it back into a dataframe so
that we could compare the results for two countries more easily. In Pandas, you can do that with one command: <code>unstack</code>.
</p>
</div>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country</span><span class="p">[</span><span class="s1">&#39;BloodType&#39;</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>468.0</td>
      <td>59.0</td>
      <td>100.0</td>
      <td>8.0</td>
      <td>419.0</td>
      <td>24.0</td>
      <td>648.0</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>France</th>
      <td>145.0</td>
      <td>17.0</td>
      <td>19.0</td>
      <td>1.0</td>
      <td>106.0</td>
      <td>4.0</td>
      <td>184.0</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>45.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>44.0</td>
      <td>5.0</td>
      <td>86.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>207.0</td>
      <td>31.0</td>
      <td>37.0</td>
      <td>5.0</td>
      <td>185.0</td>
      <td>4.0</td>
      <td>299.0</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>154.0</td>
      <td>9.0</td>
      <td>21.0</td>
      <td>5.0</td>
      <td>100.0</td>
      <td>5.0</td>
      <td>185.0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>132.0</td>
      <td>23.0</td>
      <td>25.0</td>
      <td>4.0</td>
      <td>102.0</td>
      <td>7.0</td>
      <td>188.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>157.0</td>
      <td>25.0</td>
      <td>35.0</td>
      <td>4.0</td>
      <td>157.0</td>
      <td>15.0</td>
      <td>273.0</td>
      <td>34.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>If we want to switch the index and the columns around, we need to specify the <code>level</code> parameter in  <code>unstack()</code> which, by default, is -1, that is the last (innermost) level of the index.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country</span><span class="p">[</span><span class="s1">&#39;BloodType&#39;</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Country</th>
      <th>Australia</th>
      <th>France</th>
      <th>Iceland</th>
      <th>Italy</th>
      <th>New Zealand</th>
      <th>United Kingdom</th>
      <th>United States</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A+</th>
      <td>468.0</td>
      <td>145.0</td>
      <td>45.0</td>
      <td>207.0</td>
      <td>154.0</td>
      <td>132.0</td>
      <td>157.0</td>
    </tr>
    <tr>
      <th>A-</th>
      <td>59.0</td>
      <td>17.0</td>
      <td>6.0</td>
      <td>31.0</td>
      <td>9.0</td>
      <td>23.0</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>AB+</th>
      <td>100.0</td>
      <td>19.0</td>
      <td>5.0</td>
      <td>37.0</td>
      <td>21.0</td>
      <td>25.0</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>AB-</th>
      <td>8.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>B+</th>
      <td>419.0</td>
      <td>106.0</td>
      <td>44.0</td>
      <td>185.0</td>
      <td>100.0</td>
      <td>102.0</td>
      <td>157.0</td>
    </tr>
    <tr>
      <th>B-</th>
      <td>24.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>O+</th>
      <td>648.0</td>
      <td>184.0</td>
      <td>86.0</td>
      <td>299.0</td>
      <td>185.0</td>
      <td>188.0</td>
      <td>273.0</td>
    </tr>
    <tr>
      <th>O-</th>
      <td>74.0</td>
      <td>24.0</td>
      <td>9.0</td>
      <td>32.0</td>
      <td>21.0</td>
      <td>19.0</td>
      <td>34.0</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="the-level-can-also-be-specified-by-name">The level can also be specified by name</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country</span><span class="p">[</span><span class="s1">&#39;BloodType&#39;</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;Country&#39;</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Country</th>
      <th>Australia</th>
      <th>France</th>
      <th>Iceland</th>
      <th>Italy</th>
      <th>New Zealand</th>
      <th>United Kingdom</th>
      <th>United States</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A+</th>
      <td>468.0</td>
      <td>145.0</td>
      <td>45.0</td>
      <td>207.0</td>
      <td>154.0</td>
      <td>132.0</td>
      <td>157.0</td>
    </tr>
    <tr>
      <th>A-</th>
      <td>59.0</td>
      <td>17.0</td>
      <td>6.0</td>
      <td>31.0</td>
      <td>9.0</td>
      <td>23.0</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>AB+</th>
      <td>100.0</td>
      <td>19.0</td>
      <td>5.0</td>
      <td>37.0</td>
      <td>21.0</td>
      <td>25.0</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>AB-</th>
      <td>8.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>B+</th>
      <td>419.0</td>
      <td>106.0</td>
      <td>44.0</td>
      <td>185.0</td>
      <td>100.0</td>
      <td>102.0</td>
      <td>157.0</td>
    </tr>
    <tr>
      <th>B-</th>
      <td>24.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>O+</th>
      <td>648.0</td>
      <td>184.0</td>
      <td>86.0</td>
      <td>299.0</td>
      <td>185.0</td>
      <td>188.0</td>
      <td>273.0</td>
    </tr>
    <tr>
      <th>O-</th>
      <td>74.0</td>
      <td>24.0</td>
      <td>9.0</td>
      <td>32.0</td>
      <td>21.0</td>
      <td>19.0</td>
      <td>34.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>Note that we have a  bunch of <code>NaN</code> in our dataframe. This indicates that no one from Iceland has blood type <code>AB+</code> in our dataset.</p>

<p>Since there was no such data in our dataset, it appears as a <strong>missing value</strong>.</p>

<p>However, here, a value of 0 would be more appropriate. We can tell the dataframe to
replace its missing values by 0 using the <code>fillna</code> method.</p>

<p>Since we&rsquo;re dealing with count data, it&rsquo;s also a good idea to convert the type to <code>int</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country</span><span class="p">[</span><span class="s1">&#39;BloodType&#39;</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>468</td>
      <td>59</td>
      <td>100</td>
      <td>8</td>
      <td>419</td>
      <td>24</td>
      <td>648</td>
      <td>74</td>
    </tr>
    <tr>
      <th>France</th>
      <td>145</td>
      <td>17</td>
      <td>19</td>
      <td>1</td>
      <td>106</td>
      <td>4</td>
      <td>184</td>
      <td>24</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>45</td>
      <td>6</td>
      <td>5</td>
      <td>0</td>
      <td>44</td>
      <td>5</td>
      <td>86</td>
      <td>9</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>207</td>
      <td>31</td>
      <td>37</td>
      <td>5</td>
      <td>185</td>
      <td>4</td>
      <td>299</td>
      <td>32</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>154</td>
      <td>9</td>
      <td>21</td>
      <td>5</td>
      <td>100</td>
      <td>5</td>
      <td>185</td>
      <td>21</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>132</td>
      <td>23</td>
      <td>25</td>
      <td>4</td>
      <td>102</td>
      <td>7</td>
      <td>188</td>
      <td>19</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>157</td>
      <td>25</td>
      <td>35</td>
      <td>4</td>
      <td>157</td>
      <td>15</td>
      <td>273</td>
      <td>34</td>
    </tr>
  </tbody>
</table>
</div>

<div style="background-color:#F7F2E0;">
<h3> <font color=MediumVioletRed>Remark:</font> </h3>
<p>We are using <b>fake data</b> so don't give too much credence to these results. </p>

<p>This being said,  blood type frequencies do vary
across countries and you can read more about it <a href="http://en.wikipedia.org/wiki/Blood_type_distribution_by_country">here</a>.
</p>
</div>

<h3> <center><font color=MediumVioletRed>C. GroupBy on multiple features.</font></center></h3>

<p>Of, course, <code>GroupBy</code> operations aren&rsquo;t limited to single features.</p>

<p>If we want to see the data grouped by country <b>and</b> blood type , we just need to specify both features in constructing the <code>GroupBy</code> object.
<h4>Note that with a <code>groupby</code> on multiple features we can obtain the previous result in a different way.</h4></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span><span class="s1">&#39;BloodType&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>BloodType</th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>468</td>
      <td>59</td>
      <td>100</td>
      <td>8</td>
      <td>419</td>
      <td>24</td>
      <td>648</td>
      <td>74</td>
    </tr>
    <tr>
      <th>France</th>
      <td>145</td>
      <td>17</td>
      <td>19</td>
      <td>1</td>
      <td>106</td>
      <td>4</td>
      <td>184</td>
      <td>24</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>45</td>
      <td>6</td>
      <td>5</td>
      <td>0</td>
      <td>44</td>
      <td>5</td>
      <td>86</td>
      <td>9</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>207</td>
      <td>31</td>
      <td>37</td>
      <td>5</td>
      <td>185</td>
      <td>4</td>
      <td>299</td>
      <td>32</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>154</td>
      <td>9</td>
      <td>21</td>
      <td>5</td>
      <td>100</td>
      <td>5</td>
      <td>185</td>
      <td>21</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>132</td>
      <td>23</td>
      <td>25</td>
      <td>4</td>
      <td>102</td>
      <td>7</td>
      <td>188</td>
      <td>19</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>157</td>
      <td>25</td>
      <td>35</td>
      <td>4</td>
      <td>157</td>
      <td>15</td>
      <td>273</td>
      <td>34</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="let-s-group-our-data-based-on-country-and-gender">Let&rsquo;s group our data based on country and gender.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country_and_gender</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Gender&#39;</span><span class="p">])</span>

<span class="n">grouped_by_country_and_gender</span><span class="p">[</span><span class="s1">&#39;BloodType&#39;</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>female</th>
      <td>229.0</td>
      <td>29.0</td>
      <td>54.0</td>
      <td>4.0</td>
      <td>205.0</td>
      <td>13.0</td>
      <td>328.0</td>
      <td>41.0</td>
    </tr>
    <tr>
      <th>male</th>
      <td>239.0</td>
      <td>30.0</td>
      <td>46.0</td>
      <td>4.0</td>
      <td>214.0</td>
      <td>11.0</td>
      <td>320.0</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">France</th>
      <th>female</th>
      <td>76.0</td>
      <td>11.0</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>47.0</td>
      <td>2.0</td>
      <td>79.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>male</th>
      <td>69.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>59.0</td>
      <td>2.0</td>
      <td>105.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Iceland</th>
      <th>female</th>
      <td>22.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>17.0</td>
      <td>4.0</td>
      <td>34.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>male</th>
      <td>23.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>27.0</td>
      <td>1.0</td>
      <td>52.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Italy</th>
      <th>female</th>
      <td>102.0</td>
      <td>14.0</td>
      <td>22.0</td>
      <td>1.0</td>
      <td>89.0</td>
      <td>1.0</td>
      <td>160.0</td>
      <td>17.0</td>
    </tr>
    <tr>
      <th>male</th>
      <td>105.0</td>
      <td>17.0</td>
      <td>15.0</td>
      <td>4.0</td>
      <td>96.0</td>
      <td>3.0</td>
      <td>139.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New Zealand</th>
      <th>female</th>
      <td>75.0</td>
      <td>5.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>53.0</td>
      <td>2.0</td>
      <td>91.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>male</th>
      <td>79.0</td>
      <td>4.0</td>
      <td>13.0</td>
      <td>4.0</td>
      <td>47.0</td>
      <td>3.0</td>
      <td>94.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United Kingdom</th>
      <th>female</th>
      <td>65.0</td>
      <td>6.0</td>
      <td>14.0</td>
      <td>1.0</td>
      <td>55.0</td>
      <td>4.0</td>
      <td>99.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>male</th>
      <td>67.0</td>
      <td>17.0</td>
      <td>11.0</td>
      <td>3.0</td>
      <td>47.0</td>
      <td>3.0</td>
      <td>89.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United States</th>
      <th>female</th>
      <td>89.0</td>
      <td>13.0</td>
      <td>18.0</td>
      <td>3.0</td>
      <td>77.0</td>
      <td>7.0</td>
      <td>138.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>male</th>
      <td>68.0</td>
      <td>12.0</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>80.0</td>
      <td>8.0</td>
      <td>135.0</td>
      <td>22.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>Once again let&rsquo;s replace missing values by 0.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country_and_gender</span><span class="p">[</span><span class="s1">&#39;BloodType&#39;</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>female</th>
      <td>229</td>
      <td>29</td>
      <td>54</td>
      <td>4</td>
      <td>205</td>
      <td>13</td>
      <td>328</td>
      <td>41</td>
    </tr>
    <tr>
      <th>male</th>
      <td>239</td>
      <td>30</td>
      <td>46</td>
      <td>4</td>
      <td>214</td>
      <td>11</td>
      <td>320</td>
      <td>33</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">France</th>
      <th>female</th>
      <td>76</td>
      <td>11</td>
      <td>10</td>
      <td>0</td>
      <td>47</td>
      <td>2</td>
      <td>79</td>
      <td>16</td>
    </tr>
    <tr>
      <th>male</th>
      <td>69</td>
      <td>6</td>
      <td>9</td>
      <td>1</td>
      <td>59</td>
      <td>2</td>
      <td>105</td>
      <td>8</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Iceland</th>
      <th>female</th>
      <td>22</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>17</td>
      <td>4</td>
      <td>34</td>
      <td>8</td>
    </tr>
    <tr>
      <th>male</th>
      <td>23</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>27</td>
      <td>1</td>
      <td>52</td>
      <td>1</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Italy</th>
      <th>female</th>
      <td>102</td>
      <td>14</td>
      <td>22</td>
      <td>1</td>
      <td>89</td>
      <td>1</td>
      <td>160</td>
      <td>17</td>
    </tr>
    <tr>
      <th>male</th>
      <td>105</td>
      <td>17</td>
      <td>15</td>
      <td>4</td>
      <td>96</td>
      <td>3</td>
      <td>139</td>
      <td>15</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New Zealand</th>
      <th>female</th>
      <td>75</td>
      <td>5</td>
      <td>8</td>
      <td>1</td>
      <td>53</td>
      <td>2</td>
      <td>91</td>
      <td>9</td>
    </tr>
    <tr>
      <th>male</th>
      <td>79</td>
      <td>4</td>
      <td>13</td>
      <td>4</td>
      <td>47</td>
      <td>3</td>
      <td>94</td>
      <td>12</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United Kingdom</th>
      <th>female</th>
      <td>65</td>
      <td>6</td>
      <td>14</td>
      <td>1</td>
      <td>55</td>
      <td>4</td>
      <td>99</td>
      <td>13</td>
    </tr>
    <tr>
      <th>male</th>
      <td>67</td>
      <td>17</td>
      <td>11</td>
      <td>3</td>
      <td>47</td>
      <td>3</td>
      <td>89</td>
      <td>6</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United States</th>
      <th>female</th>
      <td>89</td>
      <td>13</td>
      <td>18</td>
      <td>3</td>
      <td>77</td>
      <td>7</td>
      <td>138</td>
      <td>12</td>
    </tr>
    <tr>
      <th>male</th>
      <td>68</td>
      <td>12</td>
      <td>17</td>
      <td>1</td>
      <td>80</td>
      <td>8</td>
      <td>135</td>
      <td>22</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country_and_gender</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Age</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>female</th>
      <td>58.101883</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.531773</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">France</th>
      <th>female</th>
      <td>59.207469</td>
    </tr>
    <tr>
      <th>male</th>
      <td>56.768340</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Iceland</th>
      <th>female</th>
      <td>57.315217</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.953704</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Italy</th>
      <th>female</th>
      <td>57.300493</td>
    </tr>
    <tr>
      <th>male</th>
      <td>55.893401</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New Zealand</th>
      <th>female</th>
      <td>55.823770</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.398438</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United Kingdom</th>
      <th>female</th>
      <td>57.284047</td>
    </tr>
    <tr>
      <th>male</th>
      <td>58.222222</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United States</th>
      <th>female</th>
      <td>57.299720</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.536443</td>
    </tr>
  </tbody>
</table>
</div>

<p>Notice how we didn&rsquo;t specify the <code>Age</code> feature. Pandas automatically outputs results for which the <code>mean</code> function makes sense. Here only Age fits the bill.</p>

<p>Like with any dataframe, you can also use <code>apply</code> to map a function to the grouped data, however, for anything more complex, like applying multiple functions at once, the <code>agg</code> method is more convenient.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country_and_gender</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">,</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;std&#39;</span><span class="p">])</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>female</th>
      <td>24</td>
      <td>91</td>
      <td>58.101883</td>
      <td>19.587278</td>
    </tr>
    <tr>
      <th>male</th>
      <td>24</td>
      <td>91</td>
      <td>57.531773</td>
      <td>19.394326</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">France</th>
      <th>female</th>
      <td>25</td>
      <td>91</td>
      <td>59.207469</td>
      <td>19.041143</td>
    </tr>
    <tr>
      <th>male</th>
      <td>24</td>
      <td>91</td>
      <td>56.768340</td>
      <td>19.961407</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Iceland</th>
      <th>female</th>
      <td>24</td>
      <td>91</td>
      <td>57.315217</td>
      <td>19.527343</td>
    </tr>
    <tr>
      <th>male</th>
      <td>24</td>
      <td>91</td>
      <td>57.953704</td>
      <td>19.490896</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Italy</th>
      <th>female</th>
      <td>24</td>
      <td>91</td>
      <td>57.300493</td>
      <td>19.116494</td>
    </tr>
    <tr>
      <th>male</th>
      <td>24</td>
      <td>90</td>
      <td>55.893401</td>
      <td>18.838508</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New Zealand</th>
      <th>female</th>
      <td>24</td>
      <td>91</td>
      <td>55.823770</td>
      <td>19.546233</td>
    </tr>
    <tr>
      <th>male</th>
      <td>24</td>
      <td>91</td>
      <td>57.398438</td>
      <td>18.570202</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United Kingdom</th>
      <th>female</th>
      <td>24</td>
      <td>91</td>
      <td>57.284047</td>
      <td>20.168651</td>
    </tr>
    <tr>
      <th>male</th>
      <td>24</td>
      <td>91</td>
      <td>58.222222</td>
      <td>18.856132</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United States</th>
      <th>female</th>
      <td>24</td>
      <td>91</td>
      <td>57.299720</td>
      <td>19.167134</td>
    </tr>
    <tr>
      <th>male</th>
      <td>24</td>
      <td>91</td>
      <td>57.536443</td>
      <td>19.434197</td>
    </tr>
  </tbody>
</table>
</div>

<p><h4> For descriptive statistics of numerical data, the <code>quantile</code> function is also useful.</h4>
<div style="background-color:#F7F2E0;">
<h3> <font color=MediumVioletRed>Remark:</font> </h3>
<p>The 0.5 quantile is the <b>median</b> of our data.</p>
</div></p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped_by_country_and_gender</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">((</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.90</span><span class="p">))</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0.1</th>
      <th>0.25</th>
      <th>0.5</th>
      <th>0.75</th>
      <th>0.9</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>female</th>
      <td>31.0</td>
      <td>41.00</td>
      <td>58.0</td>
      <td>75.00</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>male</th>
      <td>30.0</td>
      <td>41.00</td>
      <td>58.0</td>
      <td>74.00</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">France</th>
      <th>female</th>
      <td>31.0</td>
      <td>44.00</td>
      <td>61.0</td>
      <td>76.00</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>male</th>
      <td>30.0</td>
      <td>37.00</td>
      <td>57.0</td>
      <td>75.00</td>
      <td>83.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Iceland</th>
      <th>female</th>
      <td>32.1</td>
      <td>40.75</td>
      <td>59.0</td>
      <td>74.00</td>
      <td>83.9</td>
    </tr>
    <tr>
      <th>male</th>
      <td>32.0</td>
      <td>42.00</td>
      <td>56.5</td>
      <td>74.00</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Italy</th>
      <th>female</th>
      <td>31.0</td>
      <td>41.00</td>
      <td>57.0</td>
      <td>73.00</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>male</th>
      <td>31.0</td>
      <td>39.00</td>
      <td>55.0</td>
      <td>71.00</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New Zealand</th>
      <th>female</th>
      <td>29.3</td>
      <td>39.00</td>
      <td>54.0</td>
      <td>72.25</td>
      <td>83.0</td>
    </tr>
    <tr>
      <th>male</th>
      <td>32.0</td>
      <td>41.00</td>
      <td>58.0</td>
      <td>72.00</td>
      <td>83.5</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United Kingdom</th>
      <th>female</th>
      <td>29.6</td>
      <td>39.00</td>
      <td>57.0</td>
      <td>75.00</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>male</th>
      <td>30.2</td>
      <td>43.00</td>
      <td>59.0</td>
      <td>73.00</td>
      <td>83.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United States</th>
      <th>female</th>
      <td>31.0</td>
      <td>41.00</td>
      <td>57.0</td>
      <td>74.00</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>male</th>
      <td>30.0</td>
      <td>40.50</td>
      <td>58.0</td>
      <td>74.00</td>
      <td>83.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>How can we use the <code>grouped_by_country_and_gender</code> object to output the number of people who were born
on a given month (numbered 1 to 12), for each country, and for each gender?</p>

<p><b>Hint:</b>
This can be done in one line using <code>apply</code> and <code>value_counts</code>, but you need to make sure you keep track of the type of object you are dealing with at each stage of the pipeline.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Method 1 - one liner </span>
<span class="p">(</span><span class="n">grouped_by_country_and_gender</span><span class="p">[</span><span class="s1">&#39;Birthday&#39;</span><span class="p">]</span>
            <span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
            <span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
            <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>female</th>
      <td>83</td>
      <td>75</td>
      <td>70</td>
      <td>66</td>
      <td>71</td>
      <td>78</td>
      <td>90</td>
      <td>77</td>
      <td>70</td>
      <td>65</td>
      <td>73</td>
      <td>85</td>
    </tr>
    <tr>
      <th>male</th>
      <td>69</td>
      <td>64</td>
      <td>74</td>
      <td>71</td>
      <td>74</td>
      <td>57</td>
      <td>77</td>
      <td>91</td>
      <td>80</td>
      <td>81</td>
      <td>81</td>
      <td>78</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">France</th>
      <th>female</th>
      <td>26</td>
      <td>15</td>
      <td>18</td>
      <td>13</td>
      <td>30</td>
      <td>22</td>
      <td>22</td>
      <td>19</td>
      <td>11</td>
      <td>21</td>
      <td>21</td>
      <td>23</td>
    </tr>
    <tr>
      <th>male</th>
      <td>22</td>
      <td>15</td>
      <td>22</td>
      <td>28</td>
      <td>19</td>
      <td>22</td>
      <td>26</td>
      <td>23</td>
      <td>26</td>
      <td>22</td>
      <td>16</td>
      <td>18</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Iceland</th>
      <th>female</th>
      <td>7</td>
      <td>11</td>
      <td>3</td>
      <td>6</td>
      <td>5</td>
      <td>10</td>
      <td>10</td>
      <td>12</td>
      <td>9</td>
      <td>4</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>male</th>
      <td>7</td>
      <td>11</td>
      <td>15</td>
      <td>2</td>
      <td>8</td>
      <td>9</td>
      <td>11</td>
      <td>6</td>
      <td>12</td>
      <td>10</td>
      <td>9</td>
      <td>8</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Italy</th>
      <th>female</th>
      <td>31</td>
      <td>34</td>
      <td>39</td>
      <td>33</td>
      <td>36</td>
      <td>28</td>
      <td>33</td>
      <td>36</td>
      <td>36</td>
      <td>37</td>
      <td>34</td>
      <td>29</td>
    </tr>
    <tr>
      <th>male</th>
      <td>31</td>
      <td>28</td>
      <td>35</td>
      <td>41</td>
      <td>27</td>
      <td>28</td>
      <td>37</td>
      <td>33</td>
      <td>29</td>
      <td>33</td>
      <td>33</td>
      <td>39</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New Zealand</th>
      <th>female</th>
      <td>18</td>
      <td>20</td>
      <td>19</td>
      <td>21</td>
      <td>22</td>
      <td>26</td>
      <td>26</td>
      <td>15</td>
      <td>14</td>
      <td>23</td>
      <td>23</td>
      <td>17</td>
    </tr>
    <tr>
      <th>male</th>
      <td>21</td>
      <td>22</td>
      <td>16</td>
      <td>22</td>
      <td>30</td>
      <td>19</td>
      <td>16</td>
      <td>25</td>
      <td>18</td>
      <td>25</td>
      <td>23</td>
      <td>19</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United Kingdom</th>
      <th>female</th>
      <td>17</td>
      <td>21</td>
      <td>19</td>
      <td>22</td>
      <td>14</td>
      <td>20</td>
      <td>31</td>
      <td>22</td>
      <td>19</td>
      <td>24</td>
      <td>34</td>
      <td>14</td>
    </tr>
    <tr>
      <th>male</th>
      <td>21</td>
      <td>16</td>
      <td>22</td>
      <td>26</td>
      <td>20</td>
      <td>21</td>
      <td>23</td>
      <td>18</td>
      <td>17</td>
      <td>21</td>
      <td>19</td>
      <td>19</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United States</th>
      <th>female</th>
      <td>38</td>
      <td>32</td>
      <td>35</td>
      <td>24</td>
      <td>37</td>
      <td>25</td>
      <td>25</td>
      <td>25</td>
      <td>32</td>
      <td>31</td>
      <td>21</td>
      <td>32</td>
    </tr>
    <tr>
      <th>male</th>
      <td>44</td>
      <td>30</td>
      <td>23</td>
      <td>25</td>
      <td>23</td>
      <td>29</td>
      <td>31</td>
      <td>29</td>
      <td>26</td>
      <td>28</td>
      <td>26</td>
      <td>29</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Method 2 - Starting from the original data</span>
<span class="c1"># create a month series first and use it to perform groupby</span>

<span class="n">months</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Birthday</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
<span class="p">(</span><span class="n">data</span>
   <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="n">months</span><span class="p">])[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span>
   <span class="o">.</span><span class="n">count</span><span class="p">()</span>
   <span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
   <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Birthday</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>female</th>
      <td>83</td>
      <td>75</td>
      <td>70</td>
      <td>66</td>
      <td>71</td>
      <td>78</td>
      <td>90</td>
      <td>77</td>
      <td>70</td>
      <td>65</td>
      <td>73</td>
      <td>85</td>
    </tr>
    <tr>
      <th>male</th>
      <td>69</td>
      <td>64</td>
      <td>74</td>
      <td>71</td>
      <td>74</td>
      <td>57</td>
      <td>77</td>
      <td>91</td>
      <td>80</td>
      <td>81</td>
      <td>81</td>
      <td>78</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">France</th>
      <th>female</th>
      <td>26</td>
      <td>15</td>
      <td>18</td>
      <td>13</td>
      <td>30</td>
      <td>22</td>
      <td>22</td>
      <td>19</td>
      <td>11</td>
      <td>21</td>
      <td>21</td>
      <td>23</td>
    </tr>
    <tr>
      <th>male</th>
      <td>22</td>
      <td>15</td>
      <td>22</td>
      <td>28</td>
      <td>19</td>
      <td>22</td>
      <td>26</td>
      <td>23</td>
      <td>26</td>
      <td>22</td>
      <td>16</td>
      <td>18</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Iceland</th>
      <th>female</th>
      <td>7</td>
      <td>11</td>
      <td>3</td>
      <td>6</td>
      <td>5</td>
      <td>10</td>
      <td>10</td>
      <td>12</td>
      <td>9</td>
      <td>4</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>male</th>
      <td>7</td>
      <td>11</td>
      <td>15</td>
      <td>2</td>
      <td>8</td>
      <td>9</td>
      <td>11</td>
      <td>6</td>
      <td>12</td>
      <td>10</td>
      <td>9</td>
      <td>8</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Italy</th>
      <th>female</th>
      <td>31</td>
      <td>34</td>
      <td>39</td>
      <td>33</td>
      <td>36</td>
      <td>28</td>
      <td>33</td>
      <td>36</td>
      <td>36</td>
      <td>37</td>
      <td>34</td>
      <td>29</td>
    </tr>
    <tr>
      <th>male</th>
      <td>31</td>
      <td>28</td>
      <td>35</td>
      <td>41</td>
      <td>27</td>
      <td>28</td>
      <td>37</td>
      <td>33</td>
      <td>29</td>
      <td>33</td>
      <td>33</td>
      <td>39</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New Zealand</th>
      <th>female</th>
      <td>18</td>
      <td>20</td>
      <td>19</td>
      <td>21</td>
      <td>22</td>
      <td>26</td>
      <td>26</td>
      <td>15</td>
      <td>14</td>
      <td>23</td>
      <td>23</td>
      <td>17</td>
    </tr>
    <tr>
      <th>male</th>
      <td>21</td>
      <td>22</td>
      <td>16</td>
      <td>22</td>
      <td>30</td>
      <td>19</td>
      <td>16</td>
      <td>25</td>
      <td>18</td>
      <td>25</td>
      <td>23</td>
      <td>19</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United Kingdom</th>
      <th>female</th>
      <td>17</td>
      <td>21</td>
      <td>19</td>
      <td>22</td>
      <td>14</td>
      <td>20</td>
      <td>31</td>
      <td>22</td>
      <td>19</td>
      <td>24</td>
      <td>34</td>
      <td>14</td>
    </tr>
    <tr>
      <th>male</th>
      <td>21</td>
      <td>16</td>
      <td>22</td>
      <td>26</td>
      <td>20</td>
      <td>21</td>
      <td>23</td>
      <td>18</td>
      <td>17</td>
      <td>21</td>
      <td>19</td>
      <td>19</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United States</th>
      <th>female</th>
      <td>38</td>
      <td>32</td>
      <td>35</td>
      <td>24</td>
      <td>37</td>
      <td>25</td>
      <td>25</td>
      <td>25</td>
      <td>32</td>
      <td>31</td>
      <td>21</td>
      <td>32</td>
    </tr>
    <tr>
      <th>male</th>
      <td>44</td>
      <td>30</td>
      <td>23</td>
      <td>25</td>
      <td>23</td>
      <td>29</td>
      <td>31</td>
      <td>29</td>
      <td>26</td>
      <td>28</td>
      <td>26</td>
      <td>29</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Note that although we&#39;ve used &#39;Age&#39; here, any feature would have done. </span>
<span class="c1"># Do you see why?</span>

<span class="c1"># Method 3 - Starting from the original data and assign a new month column</span>
<span class="p">(</span><span class="n">data</span>
   <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">Birthday</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
   <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Gender&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">])[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span>
   <span class="o">.</span><span class="n">count</span><span class="p">()</span>
   <span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
   <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>month</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>female</th>
      <td>83</td>
      <td>75</td>
      <td>70</td>
      <td>66</td>
      <td>71</td>
      <td>78</td>
      <td>90</td>
      <td>77</td>
      <td>70</td>
      <td>65</td>
      <td>73</td>
      <td>85</td>
    </tr>
    <tr>
      <th>male</th>
      <td>69</td>
      <td>64</td>
      <td>74</td>
      <td>71</td>
      <td>74</td>
      <td>57</td>
      <td>77</td>
      <td>91</td>
      <td>80</td>
      <td>81</td>
      <td>81</td>
      <td>78</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">France</th>
      <th>female</th>
      <td>26</td>
      <td>15</td>
      <td>18</td>
      <td>13</td>
      <td>30</td>
      <td>22</td>
      <td>22</td>
      <td>19</td>
      <td>11</td>
      <td>21</td>
      <td>21</td>
      <td>23</td>
    </tr>
    <tr>
      <th>male</th>
      <td>22</td>
      <td>15</td>
      <td>22</td>
      <td>28</td>
      <td>19</td>
      <td>22</td>
      <td>26</td>
      <td>23</td>
      <td>26</td>
      <td>22</td>
      <td>16</td>
      <td>18</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Iceland</th>
      <th>female</th>
      <td>7</td>
      <td>11</td>
      <td>3</td>
      <td>6</td>
      <td>5</td>
      <td>10</td>
      <td>10</td>
      <td>12</td>
      <td>9</td>
      <td>4</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>male</th>
      <td>7</td>
      <td>11</td>
      <td>15</td>
      <td>2</td>
      <td>8</td>
      <td>9</td>
      <td>11</td>
      <td>6</td>
      <td>12</td>
      <td>10</td>
      <td>9</td>
      <td>8</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Italy</th>
      <th>female</th>
      <td>31</td>
      <td>34</td>
      <td>39</td>
      <td>33</td>
      <td>36</td>
      <td>28</td>
      <td>33</td>
      <td>36</td>
      <td>36</td>
      <td>37</td>
      <td>34</td>
      <td>29</td>
    </tr>
    <tr>
      <th>male</th>
      <td>31</td>
      <td>28</td>
      <td>35</td>
      <td>41</td>
      <td>27</td>
      <td>28</td>
      <td>37</td>
      <td>33</td>
      <td>29</td>
      <td>33</td>
      <td>33</td>
      <td>39</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New Zealand</th>
      <th>female</th>
      <td>18</td>
      <td>20</td>
      <td>19</td>
      <td>21</td>
      <td>22</td>
      <td>26</td>
      <td>26</td>
      <td>15</td>
      <td>14</td>
      <td>23</td>
      <td>23</td>
      <td>17</td>
    </tr>
    <tr>
      <th>male</th>
      <td>21</td>
      <td>22</td>
      <td>16</td>
      <td>22</td>
      <td>30</td>
      <td>19</td>
      <td>16</td>
      <td>25</td>
      <td>18</td>
      <td>25</td>
      <td>23</td>
      <td>19</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United Kingdom</th>
      <th>female</th>
      <td>17</td>
      <td>21</td>
      <td>19</td>
      <td>22</td>
      <td>14</td>
      <td>20</td>
      <td>31</td>
      <td>22</td>
      <td>19</td>
      <td>24</td>
      <td>34</td>
      <td>14</td>
    </tr>
    <tr>
      <th>male</th>
      <td>21</td>
      <td>16</td>
      <td>22</td>
      <td>26</td>
      <td>20</td>
      <td>21</td>
      <td>23</td>
      <td>18</td>
      <td>17</td>
      <td>21</td>
      <td>19</td>
      <td>19</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United States</th>
      <th>female</th>
      <td>38</td>
      <td>32</td>
      <td>35</td>
      <td>24</td>
      <td>37</td>
      <td>25</td>
      <td>25</td>
      <td>25</td>
      <td>32</td>
      <td>31</td>
      <td>21</td>
      <td>32</td>
    </tr>
    <tr>
      <th>male</th>
      <td>44</td>
      <td>30</td>
      <td>23</td>
      <td>25</td>
      <td>23</td>
      <td>29</td>
      <td>31</td>
      <td>29</td>
      <td>26</td>
      <td>28</td>
      <td>26</td>
      <td>29</td>
    </tr>
  </tbody>
</table>
</div>

<h3> <center><font color=MediumVioletRed>D. MultiIndex.</font></center></h3>

<p><h4> We can of course group the data by more than 2 features.</h4>
However, results might get a bit harder to take in.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span><span class="s1">&#39;Gender&#39;</span><span class="p">,</span><span class="s1">&#39;BloodType&#39;</span><span class="p">])[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">s</span></code></pre></div><div class="highlight"><pre class="chroma">Country         Gender  BloodType
Australia       female  A+           59.36
                        A-           59.90
                        AB+          53.13
                        AB-          61.50
                        B+           56.62
                        B-           66.00
                        O+           58.46
                        O-           58.02
                male    A+           57.67
                        A-           51.70
                        AB+          59.98
                        AB-          62.00
                        B+           58.79
                        B-           44.73
                        O+           56.94
                        O-           59.76
France          female  A+           58.54
                        A-           53.09
                        AB+          63.40
                        B+           58.47
                        B-           61.50
                        O+           60.18
                        O-           61.06
                male    A+           60.81
                        A-           56.00
                        AB+          62.78
                        AB-          41.00
                        B+           55.03
                        B-           67.00
                        O+           53.90
                                     ...  
United Kingdom  female  AB+          49.79
                        AB-          63.00
                        B+           55.33
                        B-           65.50
                        O+           57.16
                        O-           63.23
                male    A+           57.39
                        A-           60.41
                        AB+          53.91
                        AB-          65.33
                        B+           59.68
                        B-           32.67
                        O+           58.37
                        O-           64.83
United States   female  A+           57.46
                        A-           71.54
                        AB+          58.44
                        AB-          53.67
                        B+           55.75
                        B-           65.57
                        O+           57.57
                        O-           41.83
                male    A+           55.07
                        A-           47.08
                        AB+          55.12
                        AB-          66.00
                        B+           54.34
                        B-           71.25
                        O+           61.33
                        O-           55.73
Name: Age, Length: 109, dtype: float64</pre></div>
<div style="background-color:#F7F2E0;">
<h3> <font color=MediumVioletRed>Remark:</font> </h3>
<p><code>s</code> is a Pandas <code>Series</code> object with a <code>MultiIndex</code> object as its index.
</p>
</div>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span><span class="o">.</span><span class="n">index</span></code></pre></div><div class="highlight"><pre class="chroma">MultiIndex(levels=[[&#39;Australia&#39;, &#39;France&#39;, &#39;Iceland&#39;, &#39;Italy&#39;, &#39;New Zealand&#39;, &#39;United Kingdom&#39;, &#39;United States&#39;], [&#39;female&#39;, &#39;male&#39;], [&#39;A+&#39;, &#39;A-&#39;, &#39;AB+&#39;, &#39;AB-&#39;, &#39;B+&#39;, &#39;B-&#39;, &#39;O+&#39;, &#39;O-&#39;]],
           codes=[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6], [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1], [0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 4, 5, 6, 7, 0, 1, 2, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7, 0, 1, 2, 3, 4, 5, 6, 7]],
           names=[&#39;Country&#39;, &#39;Gender&#39;, &#39;BloodType&#39;])</pre></div>
<p>We can convert the MultiIndexed series to a MultiIndexed dataframe using unstack.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BloodType</th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>female</th>
      <td>59.36</td>
      <td>59.90</td>
      <td>53.13</td>
      <td>61.50</td>
      <td>56.62</td>
      <td>66.00</td>
      <td>58.46</td>
      <td>58.02</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.67</td>
      <td>51.70</td>
      <td>59.98</td>
      <td>62.00</td>
      <td>58.79</td>
      <td>44.73</td>
      <td>56.94</td>
      <td>59.76</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">France</th>
      <th>female</th>
      <td>58.54</td>
      <td>53.09</td>
      <td>63.40</td>
      <td>0.00</td>
      <td>58.47</td>
      <td>61.50</td>
      <td>60.18</td>
      <td>61.06</td>
    </tr>
    <tr>
      <th>male</th>
      <td>60.81</td>
      <td>56.00</td>
      <td>62.78</td>
      <td>41.00</td>
      <td>55.03</td>
      <td>67.00</td>
      <td>53.90</td>
      <td>65.62</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Iceland</th>
      <th>female</th>
      <td>56.95</td>
      <td>63.40</td>
      <td>63.00</td>
      <td>0.00</td>
      <td>60.06</td>
      <td>67.25</td>
      <td>53.15</td>
      <td>60.00</td>
    </tr>
    <tr>
      <th>male</th>
      <td>62.09</td>
      <td>35.00</td>
      <td>57.00</td>
      <td>0.00</td>
      <td>59.37</td>
      <td>74.00</td>
      <td>55.13</td>
      <td>81.00</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Italy</th>
      <th>female</th>
      <td>55.68</td>
      <td>55.36</td>
      <td>68.50</td>
      <td>46.00</td>
      <td>56.07</td>
      <td>57.00</td>
      <td>57.96</td>
      <td>55.12</td>
    </tr>
    <tr>
      <th>male</th>
      <td>54.45</td>
      <td>54.47</td>
      <td>62.60</td>
      <td>44.75</td>
      <td>54.82</td>
      <td>66.00</td>
      <td>57.32</td>
      <td>55.47</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New Zealand</th>
      <th>female</th>
      <td>57.49</td>
      <td>59.20</td>
      <td>50.50</td>
      <td>67.00</td>
      <td>58.19</td>
      <td>45.00</td>
      <td>53.22</td>
      <td>58.33</td>
    </tr>
    <tr>
      <th>male</th>
      <td>60.39</td>
      <td>74.75</td>
      <td>65.08</td>
      <td>64.00</td>
      <td>53.96</td>
      <td>52.33</td>
      <td>54.68</td>
      <td>57.42</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United Kingdom</th>
      <th>female</th>
      <td>58.42</td>
      <td>63.17</td>
      <td>49.79</td>
      <td>63.00</td>
      <td>55.33</td>
      <td>65.50</td>
      <td>57.16</td>
      <td>63.23</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.39</td>
      <td>60.41</td>
      <td>53.91</td>
      <td>65.33</td>
      <td>59.68</td>
      <td>32.67</td>
      <td>58.37</td>
      <td>64.83</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United States</th>
      <th>female</th>
      <td>57.46</td>
      <td>71.54</td>
      <td>58.44</td>
      <td>53.67</td>
      <td>55.75</td>
      <td>65.57</td>
      <td>57.57</td>
      <td>41.83</td>
    </tr>
    <tr>
      <th>male</th>
      <td>55.07</td>
      <td>47.08</td>
      <td>55.12</td>
      <td>66.00</td>
      <td>54.34</td>
      <td>71.25</td>
      <td>61.33</td>
      <td>55.73</td>
    </tr>
  </tbody>
</table>
</div>

<p>To access specific data using the MultiIndex for a <strong>Series</strong>, you can use the <code>xs</code> method and specify the level at which you are extracting the data, if you are not using the top level.</p>

<p>To access specific data using the MultiIndex for a <strong>DataFrame</strong>, you can use the <code>loc</code> method, but specifying the level is a bit more involved.</p>

<h4 id="top-level-selection">Top level selection</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span><span class="p">[</span><span class="s1">&#39;Australia&#39;</span><span class="p">]</span></code></pre></div><div class="highlight"><pre class="chroma">Gender  BloodType
female  A+           59.36
        A-           59.90
        AB+          53.13
        AB-          61.50
        B+           56.62
        B-           66.00
        O+           58.46
        O-           58.02
male    A+           57.67
        A-           51.70
        AB+          59.98
        AB-          62.00
        B+           58.79
        B-           44.73
        O+           56.94
        O-           59.76
Name: Age, dtype: float64</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Australia&#39;</span><span class="p">,</span> <span class="p">:]</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>BloodType</th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
    </tr>
    <tr>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>59.36</td>
      <td>59.9</td>
      <td>53.13</td>
      <td>61.5</td>
      <td>56.62</td>
      <td>66.00</td>
      <td>58.46</td>
      <td>58.02</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.67</td>
      <td>51.7</td>
      <td>59.98</td>
      <td>62.0</td>
      <td>58.79</td>
      <td>44.73</td>
      <td>56.94</td>
      <td>59.76</td>
    </tr>
  </tbody>
</table>
</div>

<p>This is equivalent to:</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span><span class="p">[</span><span class="s1">&#39;Australia&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>BloodType</th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
    </tr>
    <tr>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>59.36</td>
      <td>59.9</td>
      <td>53.13</td>
      <td>61.5</td>
      <td>56.62</td>
      <td>66.00</td>
      <td>58.46</td>
      <td>58.02</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.67</td>
      <td>51.7</td>
      <td>59.98</td>
      <td>62.0</td>
      <td>58.79</td>
      <td>44.73</td>
      <td>56.94</td>
      <td>59.76</td>
    </tr>
  </tbody>
</table>
</div>

<p>The levels can be exchanged either by unstacking the right level, or by transposing the resulting dataframe.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span><span class="p">[</span><span class="s1">&#39;Australia&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;Gender&#39;</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Gender</th>
      <th>female</th>
      <th>male</th>
    </tr>
    <tr>
      <th>BloodType</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A+</th>
      <td>59.36</td>
      <td>57.67</td>
    </tr>
    <tr>
      <th>A-</th>
      <td>59.90</td>
      <td>51.70</td>
    </tr>
    <tr>
      <th>AB+</th>
      <td>53.13</td>
      <td>59.98</td>
    </tr>
    <tr>
      <th>AB-</th>
      <td>61.50</td>
      <td>62.00</td>
    </tr>
    <tr>
      <th>B+</th>
      <td>56.62</td>
      <td>58.79</td>
    </tr>
    <tr>
      <th>B-</th>
      <td>66.00</td>
      <td>44.73</td>
    </tr>
    <tr>
      <th>O+</th>
      <td>58.46</td>
      <td>56.94</td>
    </tr>
    <tr>
      <th>O-</th>
      <td>58.02</td>
      <td>59.76</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span><span class="p">[</span><span class="s1">&#39;Australia&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">T</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Gender</th>
      <th>female</th>
      <th>male</th>
    </tr>
    <tr>
      <th>BloodType</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A+</th>
      <td>59.36</td>
      <td>57.67</td>
    </tr>
    <tr>
      <th>A-</th>
      <td>59.90</td>
      <td>51.70</td>
    </tr>
    <tr>
      <th>AB+</th>
      <td>53.13</td>
      <td>59.98</td>
    </tr>
    <tr>
      <th>AB-</th>
      <td>61.50</td>
      <td>62.00</td>
    </tr>
    <tr>
      <th>B+</th>
      <td>56.62</td>
      <td>58.79</td>
    </tr>
    <tr>
      <th>B-</th>
      <td>66.00</td>
      <td>44.73</td>
    </tr>
    <tr>
      <th>O+</th>
      <td>58.46</td>
      <td>56.94</td>
    </tr>
    <tr>
      <th>O-</th>
      <td>58.02</td>
      <td>59.76</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="to-select-data-at-a-deeper-level-of-the-multiindex-you-need-to-specify-the-level">To select data at a deeper level of the multiindex, you need to  specify the level.</h4>

<h4 id="here-s-an-example-with-gender">Here&rsquo;s an example with Gender.</h4>

<p>Notice the different syntax using <code>xs</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;Gender&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>BloodType</th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>59.36</td>
      <td>59.90</td>
      <td>53.13</td>
      <td>61.50</td>
      <td>56.62</td>
      <td>66.00</td>
      <td>58.46</td>
      <td>58.02</td>
    </tr>
    <tr>
      <th>France</th>
      <td>58.54</td>
      <td>53.09</td>
      <td>63.40</td>
      <td>NaN</td>
      <td>58.47</td>
      <td>61.50</td>
      <td>60.18</td>
      <td>61.06</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>56.95</td>
      <td>63.40</td>
      <td>63.00</td>
      <td>NaN</td>
      <td>60.06</td>
      <td>67.25</td>
      <td>53.15</td>
      <td>60.00</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>55.68</td>
      <td>55.36</td>
      <td>68.50</td>
      <td>46.00</td>
      <td>56.07</td>
      <td>57.00</td>
      <td>57.96</td>
      <td>55.12</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>57.49</td>
      <td>59.20</td>
      <td>50.50</td>
      <td>67.00</td>
      <td>58.19</td>
      <td>45.00</td>
      <td>53.22</td>
      <td>58.33</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>58.42</td>
      <td>63.17</td>
      <td>49.79</td>
      <td>63.00</td>
      <td>55.33</td>
      <td>65.50</td>
      <td>57.16</td>
      <td>63.23</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>57.46</td>
      <td>71.54</td>
      <td>58.44</td>
      <td>53.67</td>
      <td>55.75</td>
      <td>65.57</td>
      <td>57.57</td>
      <td>41.83</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="selecting-the-data-from-a-deeper-level-is-trickier-with-a-dataframe">Selecting the data from a deeper level is trickier with a dataframe.</h4>

<h4 id="we-need-to-specify-an-index-slice">We need to specify an index <code>slice</code>.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="nb">slice</span><span class="p">(</span><span class="bp">None</span><span class="p">),</span> <span class="s1">&#39;female&#39;</span><span class="p">),</span> <span class="p">:]</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="s1">&#39;Gender&#39;</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>BloodType</th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>59.36</td>
      <td>59.90</td>
      <td>53.13</td>
      <td>61.50</td>
      <td>56.62</td>
      <td>66.00</td>
      <td>58.46</td>
      <td>58.02</td>
    </tr>
    <tr>
      <th>France</th>
      <td>58.54</td>
      <td>53.09</td>
      <td>63.40</td>
      <td>0.00</td>
      <td>58.47</td>
      <td>61.50</td>
      <td>60.18</td>
      <td>61.06</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>56.95</td>
      <td>63.40</td>
      <td>63.00</td>
      <td>0.00</td>
      <td>60.06</td>
      <td>67.25</td>
      <td>53.15</td>
      <td>60.00</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>55.68</td>
      <td>55.36</td>
      <td>68.50</td>
      <td>46.00</td>
      <td>56.07</td>
      <td>57.00</td>
      <td>57.96</td>
      <td>55.12</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>57.49</td>
      <td>59.20</td>
      <td>50.50</td>
      <td>67.00</td>
      <td>58.19</td>
      <td>45.00</td>
      <td>53.22</td>
      <td>58.33</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>58.42</td>
      <td>63.17</td>
      <td>49.79</td>
      <td>63.00</td>
      <td>55.33</td>
      <td>65.50</td>
      <td>57.16</td>
      <td>63.23</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>57.46</td>
      <td>71.54</td>
      <td>58.44</td>
      <td>53.67</td>
      <td>55.75</td>
      <td>65.57</td>
      <td>57.57</td>
      <td>41.83</td>
    </tr>
  </tbody>
</table>
</div>

<p>or alternatively, using a pandas <code>IndexSlice</code> object.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span> <span class="s1">&#39;female&#39;</span><span class="p">],</span> <span class="p">:]</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="s1">&#39;Gender&#39;</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>BloodType</th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>59.36</td>
      <td>59.90</td>
      <td>53.13</td>
      <td>61.50</td>
      <td>56.62</td>
      <td>66.00</td>
      <td>58.46</td>
      <td>58.02</td>
    </tr>
    <tr>
      <th>France</th>
      <td>58.54</td>
      <td>53.09</td>
      <td>63.40</td>
      <td>0.00</td>
      <td>58.47</td>
      <td>61.50</td>
      <td>60.18</td>
      <td>61.06</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>56.95</td>
      <td>63.40</td>
      <td>63.00</td>
      <td>0.00</td>
      <td>60.06</td>
      <td>67.25</td>
      <td>53.15</td>
      <td>60.00</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>55.68</td>
      <td>55.36</td>
      <td>68.50</td>
      <td>46.00</td>
      <td>56.07</td>
      <td>57.00</td>
      <td>57.96</td>
      <td>55.12</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>57.49</td>
      <td>59.20</td>
      <td>50.50</td>
      <td>67.00</td>
      <td>58.19</td>
      <td>45.00</td>
      <td>53.22</td>
      <td>58.33</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>58.42</td>
      <td>63.17</td>
      <td>49.79</td>
      <td>63.00</td>
      <td>55.33</td>
      <td>65.50</td>
      <td>57.16</td>
      <td>63.23</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>57.46</td>
      <td>71.54</td>
      <td>58.44</td>
      <td>53.67</td>
      <td>55.75</td>
      <td>65.57</td>
      <td>57.57</td>
      <td>41.83</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="same-if-you-want-to-select-bloodtype-as-the-level">Same if you want to select <code>BloodType</code> as the level.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;O+&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;BloodType&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Gender</th>
      <th>female</th>
      <th>male</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>58.46</td>
      <td>56.94</td>
    </tr>
    <tr>
      <th>France</th>
      <td>60.18</td>
      <td>53.90</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>53.15</td>
      <td>55.13</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>57.96</td>
      <td>57.32</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>53.22</td>
      <td>54.68</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>57.16</td>
      <td>58.37</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>57.57</td>
      <td>61.33</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;O+&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="s1">&#39;BloodType&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Gender</th>
      <th>female</th>
      <th>male</th>
    </tr>
    <tr>
      <th>Country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <td>58.46</td>
      <td>56.94</td>
    </tr>
    <tr>
      <th>France</th>
      <td>60.18</td>
      <td>53.90</td>
    </tr>
    <tr>
      <th>Iceland</th>
      <td>53.15</td>
      <td>55.13</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>57.96</td>
      <td>57.32</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>53.22</td>
      <td>54.68</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>57.16</td>
      <td>58.37</td>
    </tr>
    <tr>
      <th>United States</th>
      <td>57.57</td>
      <td>61.33</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="multiple-levels-can-be-specified-at-once">Multiple levels can be specified at once</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span><span class="o">.</span><span class="n">xs</span><span class="p">((</span><span class="s1">&#39;Australia&#39;</span><span class="p">,</span><span class="s1">&#39;female&#39;</span><span class="p">),</span> <span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span><span class="s1">&#39;Gender&#39;</span><span class="p">])</span></code></pre></div><div class="highlight"><pre class="chroma">BloodType
A+     59.36
A-     59.90
AB+    53.13
AB-    61.50
B+     56.62
B-     66.00
O+     58.46
O-     58.02
Name: Age, dtype: float64</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="s1">&#39;Australia&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">),</span> <span class="p">:]</span></code></pre></div><div class="highlight"><pre class="chroma">BloodType
A+     59.36
A-     59.90
AB+    53.13
AB-    61.50
B+     56.62
B-     66.00
O+     58.46
O-     58.02
Name: (Australia, female), dtype: float64</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">s</span><span class="o">.</span><span class="n">xs</span><span class="p">((</span><span class="s1">&#39;Australia&#39;</span><span class="p">,</span><span class="s1">&#39;O+&#39;</span><span class="p">),</span> <span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span><span class="s1">&#39;BloodType&#39;</span><span class="p">])</span></code></pre></div><div class="highlight"><pre class="chroma">Gender
female    58.46
male      56.94
Name: Age, dtype: float64</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Australia&#39;</span><span class="p">,</span> <span class="s1">&#39;O+&#39;</span><span class="p">]</span></code></pre></div><div class="highlight"><pre class="chroma">Gender
female    58.46
male      56.94
Name: O+, dtype: float64</pre></div>
<h3 id="let-s-visualise-some-of-these-results">Let&rsquo;s visualise some of these results</h3>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># colormap from matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="c1"># Also see this stackoverflow post for the legend placement: </span>
<span class="c1"># http://stackoverflow.com/questions/23556153/how-to-put-legend-outside-the-plot-with-pandas</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;Gender&#39;</span><span class="p">)</span>
       <span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
       <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
       <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> 
             <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> 
             <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> 
             <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> 
             <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
             <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
             <span class="n">colormap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">Paired_r</span><span class="p">)</span>
     <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></div>
<p><img src="output_105_0.png" alt="png" /></p>

<h4 id="notice-the-difference-between-the-previous-plot-and-the-one-below">Notice the difference between the previous plot and the one below.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">ax</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;Gender&#39;</span><span class="p">)</span>
       <span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)</span>
       <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
       <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> 
             <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> 
             <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> 
             <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> 
             <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
             <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
             <span class="n">colormap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">Paired_r</span><span class="p">)</span>
     <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></div>
<p><img src="output_107_0.png" alt="png" /></p>

<h3> <center><font color=MediumVioletRed>E. Fine Tuning.</font></center></h3>

<p>So far we&rsquo;ve applied an operation on a <b>single feature</b> of a GroupBy object.</p>

<p>For instance, we&rsquo;ve computed the mean for the <code>Age</code> feature, and then, <b>in a separate computation</b> we&rsquo;ve computed
a count of the blood types.</p>

<p>You can actually do everything at once by specifying <b>a different operation for each feature</b> using a dictionary,
and use the <code>agg</code> method to aggregate the data across the dataframe.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">group</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Gender&#39;</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">data_count</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Counter</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

<span class="n">method</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">],</span> <span class="s1">&#39;BloodType&#39;</span><span class="p">:</span> <span class="n">data_count</span><span class="p">}</span>

<span class="n">group</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;data_count&#39;</span><span class="p">:</span><span class="s1">&#39;group_counts&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead tr th {
        text-align: left;
    }
    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">Age</th>
      <th>BloodType</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>group_counts</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>female</th>
      <td>58.101883</td>
      <td>19.587278</td>
      <td>((B+, 205), (O-, 41), (AB+, 54), (O+, 328), (A...</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.531773</td>
      <td>19.394326</td>
      <td>((B+, 214), (AB+, 46), (A+, 239), (O+, 320), (...</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">France</th>
      <th>female</th>
      <td>59.207469</td>
      <td>19.041143</td>
      <td>((A-, 11), (B+, 47), (A+, 76), (O+, 79), (O-, ...</td>
    </tr>
    <tr>
      <th>male</th>
      <td>56.768340</td>
      <td>19.961407</td>
      <td>((B+, 59), (A+, 69), (AB+, 9), (O+, 105), (O-,...</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Iceland</th>
      <th>female</th>
      <td>57.315217</td>
      <td>19.527343</td>
      <td>((O+, 34), (A+, 22), (B-, 4), (B+, 17), (A-, 5...</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.953704</td>
      <td>19.490896</td>
      <td>((O+, 52), (A+, 23), (AB+, 3), (B+, 27), (O-, ...</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Italy</th>
      <th>female</th>
      <td>57.300493</td>
      <td>19.116494</td>
      <td>((A+, 102), (O+, 160), (B+, 89), (O-, 17), (AB...</td>
    </tr>
    <tr>
      <th>male</th>
      <td>55.893401</td>
      <td>18.838508</td>
      <td>((A+, 105), (O+, 139), (B+, 96), (AB-, 4), (B-...</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New Zealand</th>
      <th>female</th>
      <td>55.823770</td>
      <td>19.546233</td>
      <td>((O-, 9), (O+, 91), (A+, 75), (AB+, 8), (B+, 5...</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.398438</td>
      <td>18.570202</td>
      <td>((A+, 79), (O+, 94), (AB+, 13), (B+, 47), (O-,...</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United Kingdom</th>
      <th>female</th>
      <td>57.284047</td>
      <td>20.168651</td>
      <td>((A+, 65), (B+, 55), (O-, 13), (O+, 99), (AB+,...</td>
    </tr>
    <tr>
      <th>male</th>
      <td>58.222222</td>
      <td>18.856132</td>
      <td>((A+, 67), (B+, 47), (O-, 6), (A-, 17), (O+, 8...</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United States</th>
      <th>female</th>
      <td>57.299720</td>
      <td>19.167134</td>
      <td>((A+, 89), (B+, 77), (O+, 138), (AB+, 18), (A-...</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.536443</td>
      <td>19.434197</td>
      <td>((A+, 68), (O+, 135), (B+, 80), (A-, 12), (AB+...</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="accessing-a-particular-portion-of-the-result-is-just-a-matter-of-navigating-the-multilevel-structure-of-the-index-and-the-columns">Accessing a particular portion of the result is just a matter of navigating the multilevel structure of the index and the columns.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">group</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[[(</span><span class="s1">&#39;Australia&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">)]]</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead tr th {
        text-align: left;
    }
    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">Age</th>
      <th>BloodType</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>data_count</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <th>male</th>
      <td>57.531773</td>
      <td>19.394326</td>
      <td>((B+, 214), (AB+, 46), (A+, 239), (O+, 320), (...</td>
    </tr>
  </tbody>
</table>
</div>

<p>This is equivalent to</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">group</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="n">xs</span><span class="p">((</span><span class="s1">&#39;Australia&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">),</span> <span class="n">level</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Gender&#39;</span><span class="p">])</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead tr th {
        text-align: left;
    }
    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">Age</th>
      <th>BloodType</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>data_count</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Australia</th>
      <th>male</th>
      <td>57.531773</td>
      <td>19.394326</td>
      <td>((B+, 214), (AB+, 46), (A+, 239), (O+, 320), (...</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="notice-the-difference-with">Notice the difference with</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">group</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="n">xs</span><span class="p">((</span><span class="s1">&#39;Australia&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">))</span></code></pre></div><div class="highlight"><pre class="chroma">Age        mean                                                    57.5318
           std                                                     19.3943
BloodType  data_count    ((B+, 214), (AB+, 46), (A+, 239), (O+, 320), (...
Name: (Australia, male), dtype: object</pre></div>
<h4 id="we-can-select-data-using-levels-of-the-columns">We can select data using levels of the columns.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">group</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)]]</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead tr th {
        text-align: left;
    }
    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>Age</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>mean</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>female</th>
      <td>58.101883</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.531773</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">France</th>
      <th>female</th>
      <td>59.207469</td>
    </tr>
    <tr>
      <th>male</th>
      <td>56.768340</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Iceland</th>
      <th>female</th>
      <td>57.315217</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.953704</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Italy</th>
      <th>female</th>
      <td>57.300493</td>
    </tr>
    <tr>
      <th>male</th>
      <td>55.893401</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New Zealand</th>
      <th>female</th>
      <td>55.823770</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.398438</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United Kingdom</th>
      <th>female</th>
      <td>57.284047</td>
    </tr>
    <tr>
      <th>male</th>
      <td>58.222222</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United States</th>
      <th>female</th>
      <td>57.299720</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.536443</td>
    </tr>
  </tbody>
</table>
</div>

<p>This is equivalent to</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">group</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="n">xs</span><span class="p">([(</span><span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead tr th {
        text-align: left;
    }
    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>Age</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>mean</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>female</th>
      <td>58.101883</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.531773</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">France</th>
      <th>female</th>
      <td>59.207469</td>
    </tr>
    <tr>
      <th>male</th>
      <td>56.768340</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Iceland</th>
      <th>female</th>
      <td>57.315217</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.953704</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Italy</th>
      <th>female</th>
      <td>57.300493</td>
    </tr>
    <tr>
      <th>male</th>
      <td>55.893401</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New Zealand</th>
      <th>female</th>
      <td>55.823770</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.398438</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United Kingdom</th>
      <th>female</th>
      <td>57.284047</td>
    </tr>
    <tr>
      <th>male</th>
      <td>58.222222</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United States</th>
      <th>female</th>
      <td>57.299720</td>
    </tr>
    <tr>
      <th>male</th>
      <td>57.536443</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="you-can-go-as-deep-as-you-need">You can go as &ldquo;deep&rdquo; as you need.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">group</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Australia&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">][</span><span class="s1">&#39;Age&#39;</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span></code></pre></div><div class="highlight"><pre class="chroma">58.10188261351052</pre></div>
<p>This is equivalent to</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">group</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="n">xs</span><span class="p">((</span><span class="s1">&#39;Australia&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">))[</span><span class="s1">&#39;Age&#39;</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span></code></pre></div><div class="highlight"><pre class="chroma">58.10188261351052</pre></div>
<h4 id="to-extract-just-the-values-without-the-index-use-the-values-attribute">To extract just the values (without the index), use the <code>values</code> attribute.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">group</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">method</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Australia&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">][</span><span class="s1">&#39;BloodType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span></code></pre></div><div class="highlight"><pre class="chroma">array([dict_items([(&#39;B+&#39;, 205), (&#39;O-&#39;, 41), (&#39;AB+&#39;, 54), (&#39;O+&#39;, 328), (&#39;A+&#39;, 229), (&#39;A-&#39;, 29), (&#39;B-&#39;, 13), (&#39;AB-&#39;, 4)])],
      dtype=object)</pre></div>
<h4 id="cross-tabulation-is-an-effective-way-to-have-a-quick-look-at-how-the-data-is-distributed-across-categories">Cross-tabulation is an effective way to have a quick look at how the data is distributed across categories.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Gender</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">BloodType</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>BloodType</th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>658</td>
      <td>83</td>
      <td>128</td>
      <td>10</td>
      <td>543</td>
      <td>33</td>
      <td>929</td>
      <td>116</td>
      <td>2500</td>
    </tr>
    <tr>
      <th>male</th>
      <td>650</td>
      <td>87</td>
      <td>114</td>
      <td>17</td>
      <td>570</td>
      <td>31</td>
      <td>934</td>
      <td>97</td>
      <td>2500</td>
    </tr>
    <tr>
      <th>All</th>
      <td>1308</td>
      <td>170</td>
      <td>242</td>
      <td>27</td>
      <td>1113</td>
      <td>64</td>
      <td>1863</td>
      <td>213</td>
      <td>5000</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">([</span><span class="n">data</span><span class="o">.</span><span class="n">Country</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">Gender</span><span class="p">],</span> <span class="n">data</span><span class="o">.</span><span class="n">BloodType</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BloodType</th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Gender</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>female</th>
      <td>229</td>
      <td>29</td>
      <td>54</td>
      <td>4</td>
      <td>205</td>
      <td>13</td>
      <td>328</td>
      <td>41</td>
      <td>903</td>
    </tr>
    <tr>
      <th>male</th>
      <td>239</td>
      <td>30</td>
      <td>46</td>
      <td>4</td>
      <td>214</td>
      <td>11</td>
      <td>320</td>
      <td>33</td>
      <td>897</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">France</th>
      <th>female</th>
      <td>76</td>
      <td>11</td>
      <td>10</td>
      <td>0</td>
      <td>47</td>
      <td>2</td>
      <td>79</td>
      <td>16</td>
      <td>241</td>
    </tr>
    <tr>
      <th>male</th>
      <td>69</td>
      <td>6</td>
      <td>9</td>
      <td>1</td>
      <td>59</td>
      <td>2</td>
      <td>105</td>
      <td>8</td>
      <td>259</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Iceland</th>
      <th>female</th>
      <td>22</td>
      <td>5</td>
      <td>2</td>
      <td>0</td>
      <td>17</td>
      <td>4</td>
      <td>34</td>
      <td>8</td>
      <td>92</td>
    </tr>
    <tr>
      <th>male</th>
      <td>23</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>27</td>
      <td>1</td>
      <td>52</td>
      <td>1</td>
      <td>108</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Italy</th>
      <th>female</th>
      <td>102</td>
      <td>14</td>
      <td>22</td>
      <td>1</td>
      <td>89</td>
      <td>1</td>
      <td>160</td>
      <td>17</td>
      <td>406</td>
    </tr>
    <tr>
      <th>male</th>
      <td>105</td>
      <td>17</td>
      <td>15</td>
      <td>4</td>
      <td>96</td>
      <td>3</td>
      <td>139</td>
      <td>15</td>
      <td>394</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New Zealand</th>
      <th>female</th>
      <td>75</td>
      <td>5</td>
      <td>8</td>
      <td>1</td>
      <td>53</td>
      <td>2</td>
      <td>91</td>
      <td>9</td>
      <td>244</td>
    </tr>
    <tr>
      <th>male</th>
      <td>79</td>
      <td>4</td>
      <td>13</td>
      <td>4</td>
      <td>47</td>
      <td>3</td>
      <td>94</td>
      <td>12</td>
      <td>256</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United Kingdom</th>
      <th>female</th>
      <td>65</td>
      <td>6</td>
      <td>14</td>
      <td>1</td>
      <td>55</td>
      <td>4</td>
      <td>99</td>
      <td>13</td>
      <td>257</td>
    </tr>
    <tr>
      <th>male</th>
      <td>67</td>
      <td>17</td>
      <td>11</td>
      <td>3</td>
      <td>47</td>
      <td>3</td>
      <td>89</td>
      <td>6</td>
      <td>243</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">United States</th>
      <th>female</th>
      <td>89</td>
      <td>13</td>
      <td>18</td>
      <td>3</td>
      <td>77</td>
      <td>7</td>
      <td>138</td>
      <td>12</td>
      <td>357</td>
    </tr>
    <tr>
      <th>male</th>
      <td>68</td>
      <td>12</td>
      <td>17</td>
      <td>1</td>
      <td>80</td>
      <td>8</td>
      <td>135</td>
      <td>22</td>
      <td>343</td>
    </tr>
    <tr>
      <th>All</th>
      <th></th>
      <td>1308</td>
      <td>170</td>
      <td>242</td>
      <td>27</td>
      <td>1113</td>
      <td>64</td>
      <td>1863</td>
      <td>213</td>
      <td>5000</td>
    </tr>
  </tbody>
</table>
</div>

<h3> <center><font color=MediumVioletRed>F. GroupBy on continuous features.</font></center></h3>

<p>We&rsquo;ve seen how we can group the data according to the features that are in the original dataset.</p>

<p>For instance, grouping the data by country is trivial. Same for the blood type because these are <b>categorical</b> data.</p>

<p>But what about <code>Age</code>? If we do a <code>groupby</code> without thinking too much about it we get something rather useless.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">g</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="p">[</span><span class="s1">&#39;BloodType&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span></code></pre></div><div class="highlight"><pre class="chroma">       Age
count  24     37
       25     72
       26     73
       27     86
       28     69
       29     81
       30     71
       31     86
       32     73
       33     78
       34     54
       35     79
       36     70
       37     88
       38     70
       39     81
       40     62
       41     75
       42     66
       43     70
       44     67
       45     80
       46     85
       47     65
       48     77
       49     88
       50     77
       51     75
       52     83
       53     86
              ..
freq   62     28
       63     41
       64     26
       65     26
       66     38
       67     28
       68     35
       69     36
       70     25
       71     25
       72     39
       73     21
       74     32
       75     39
       76     21
       77     20
       78     33
       79     32
       80     30
       81     21
       82     34
       83     27
       84     25
       85     25
       86     28
       87     32
       88     23
       89     30
       90     24
       91     18
Length: 272, dtype: object</pre></div>
<p>We get one entry for each year of <code>Age</code> which isn&rsquo;t what we want.</p>

<p>Ideally, we&rsquo;d want to split the data into age groups and use that to group the data. Pandas has a <code>cut</code> function that allows us to do that.</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span></code></pre></div><div class="highlight"><pre class="chroma">count    5000.000000
mean       57.447600
std        19.339422
min        24.000000
25%        41.000000
50%        57.000000
75%        74.000000
max        91.000000
Name: Age, dtype: float64</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">bins</span></code></pre></div><div class="highlight"><pre class="chroma">array([20, 30, 40, 50, 60, 70, 80, 90])</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">labels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
<span class="n">labels</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span></code></pre></div><div class="highlight"><pre class="chroma">0    (50, 60]
1    (50, 60]
2    (50, 60]
3    (80, 90]
4    (70, 80]
Name: Age, dtype: category
Categories (7, interval[int64]): [(20, 30] &lt; (30, 40] &lt; (40, 50] &lt; (50, 60] &lt; (60, 70] &lt; (70, 80] &lt; (80, 90]]</pre></div><div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">data</span><span class="o">.</span><span class="n">Age</span><span class="o">.</span><span class="n">head</span><span class="p">()</span></code></pre></div><div class="highlight"><pre class="chroma">0    51
1    57
2    55
3    86
4    73
Name: Age, dtype: int64</pre></div>
<h4 id="we-can-use-the-newly-created-label-to-partition-the-age-variable-into-intervals">We can use the newly created label to partition the Age variable into intervals.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="p">])</span>

<span class="n">grouped</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></code></pre></div><div class="highlight"><pre class="chroma">Age             (20, 30]  (30, 40]  (40, 50]  (50, 60]  (60, 70]  (70, 80]  \
Country                                                                      
Australia            177       254       269       275       257       280   
France                48        76        68        71        75        76   
Iceland               16        32        36        24        30        26   
Italy                 74       131       120       134       128        96   
New Zealand           49        76        81        70        93        57   
United Kingdom        54        69        77        64        72        91   
United States         71       103        99       111       102       115   

Age             (80, 90]  
Country                   
Australia            272  
France                82  
Iceland               34  
Italy                111  
New Zealand           71  
United Kingdom        69  
United States         94  </pre></div>
<p>If we want the <code>Age</code> groups to be our index we can use <code>unstack(0)</code> or much the more explicit and therefore better, <code>unstack('Country')</code> .</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;Country&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Country</th>
      <th>Australia</th>
      <th>France</th>
      <th>Iceland</th>
      <th>Italy</th>
      <th>New Zealand</th>
      <th>United Kingdom</th>
      <th>United States</th>
    </tr>
    <tr>
      <th>Age</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(20, 30]</th>
      <td>177</td>
      <td>48</td>
      <td>16</td>
      <td>74</td>
      <td>49</td>
      <td>54</td>
      <td>71</td>
    </tr>
    <tr>
      <th>(30, 40]</th>
      <td>254</td>
      <td>76</td>
      <td>32</td>
      <td>131</td>
      <td>76</td>
      <td>69</td>
      <td>103</td>
    </tr>
    <tr>
      <th>(40, 50]</th>
      <td>269</td>
      <td>68</td>
      <td>36</td>
      <td>120</td>
      <td>81</td>
      <td>77</td>
      <td>99</td>
    </tr>
    <tr>
      <th>(50, 60]</th>
      <td>275</td>
      <td>71</td>
      <td>24</td>
      <td>134</td>
      <td>70</td>
      <td>64</td>
      <td>111</td>
    </tr>
    <tr>
      <th>(60, 70]</th>
      <td>257</td>
      <td>75</td>
      <td>30</td>
      <td>128</td>
      <td>93</td>
      <td>72</td>
      <td>102</td>
    </tr>
    <tr>
      <th>(70, 80]</th>
      <td>280</td>
      <td>76</td>
      <td>26</td>
      <td>96</td>
      <td>57</td>
      <td>91</td>
      <td>115</td>
    </tr>
    <tr>
      <th>(80, 90]</th>
      <td>272</td>
      <td>82</td>
      <td>34</td>
      <td>111</td>
      <td>71</td>
      <td>69</td>
      <td>94</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="just-like-before-we-can-pass-more-features-to-the-groupby-method">Just like before, we can pass more features to the <code>groupby</code> method.</h4>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="n">grouped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;BloodType&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="p">])</span>
<span class="n">grouped</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="s1">&#39;BloodType&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
    .dataframe tbody tr th {
        vertical-align: top;
    }
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BloodType</th>
      <th>A+</th>
      <th>A-</th>
      <th>AB+</th>
      <th>AB-</th>
      <th>B+</th>
      <th>B-</th>
      <th>O+</th>
      <th>O-</th>
    </tr>
    <tr>
      <th>Country</th>
      <th>Age</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="7" valign="top">Australia</th>
      <th>(20, 30]</th>
      <td>41.0</td>
      <td>11.0</td>
      <td>13.0</td>
      <td>0.0</td>
      <td>49.0</td>
      <td>3.0</td>
      <td>53.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>(30, 40]</th>
      <td>63.0</td>
      <td>8.0</td>
      <td>14.0</td>
      <td>2.0</td>
      <td>57.0</td>
      <td>4.0</td>
      <td>97.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>(40, 50]</th>
      <td>73.0</td>
      <td>9.0</td>
      <td>16.0</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>(50, 60]</th>
      <td>74.0</td>
      <td>5.0</td>
      <td>16.0</td>
      <td>0.0</td>
      <td>67.0</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>(60, 70]</th>
      <td>60.0</td>
      <td>7.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>55.0</td>
      <td>8.0</td>
      <td>106.0</td>
      <td>11.0</td>
    </tr>
    <tr>
      <th>(70, 80]</th>
      <td>85.0</td>
      <td>7.0</td>
      <td>15.0</td>
      <td>1.0</td>
      <td>57.0</td>
      <td>4.0</td>
      <td>101.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>(80, 90]</th>
      <td>65.0</td>
      <td>11.0</td>
      <td>16.0</td>
      <td>3.0</td>
      <td>77.0</td>
      <td>1.0</td>
      <td>84.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">France</th>
      <th>(20, 30]</th>
      <td>17.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>19.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>(30, 40]</th>
      <td>17.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>22.0</td>
      <td>0.0</td>
      <td>28.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>(40, 50]</th>
      <td>17.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>12.0</td>
      <td>0.0</td>
      <td>27.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>(50, 60]</th>
      <td>18.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>2.0</td>
      <td>32.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>(60, 70]</th>
      <td>23.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>18.0</td>
      <td>1.0</td>
      <td>25.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>(70, 80]</th>
      <td>22.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>26.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>(80, 90]</th>
      <td>30.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>24.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Iceland</th>
      <th>(20, 30]</th>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>(30, 40]</th>
      <td>7.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>15.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>(40, 50]</th>
      <td>5.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>17.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>(50, 60]</th>
      <td>8.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>(60, 70]</th>
      <td>5.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>(70, 80]</th>
      <td>7.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>9.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>(80, 90]</th>
      <td>9.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Italy</th>
      <th>(20, 30]</th>
      <td>19.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>22.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>(30, 40]</th>
      <td>39.0</td>
      <td>8.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>29.0</td>
      <td>0.0</td>
      <td>45.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>(40, 50]</th>
      <td>36.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>27.0</td>
      <td>1.0</td>
      <td>40.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>(50, 60]</th>
      <td>27.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>32.0</td>
      <td>1.0</td>
      <td>62.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>(60, 70]</th>
      <td>33.0</td>
      <td>2.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>27.0</td>
      <td>1.0</td>
      <td>52.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>(70, 80]</th>
      <td>33.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>22.0</td>
      <td>0.0</td>
      <td>29.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>(80, 90]</th>
      <td>19.0</td>
      <td>5.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>25.0</td>
      <td>1.0</td>
      <td>47.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">New Zealand</th>
      <th>(20, 30]</th>
      <td>13.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>22.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>(30, 40]</th>
      <td>19.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>1.0</td>
      <td>29.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>(40, 50]</th>
      <td>17.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>18.0</td>
      <td>1.0</td>
      <td>39.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>(50, 60]</th>
      <td>24.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>29.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>(60, 70]</th>
      <td>33.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>21.0</td>
      <td>0.0</td>
      <td>26.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>(70, 80]</th>
      <td>24.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>17.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>(80, 90]</th>
      <td>23.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>21.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">United Kingdom</th>
      <th>(20, 30]</th>
      <td>12.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>1.0</td>
      <td>21.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>(30, 40]</th>
      <td>21.0</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>13.0</td>
      <td>3.0</td>
      <td>23.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>(40, 50]</th>
      <td>22.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>31.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>(50, 60]</th>
      <td>14.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>14.0</td>
      <td>1.0</td>
      <td>24.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>(60, 70]</th>
      <td>15.0</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>11.0</td>
      <td>0.0</td>
      <td>31.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>(70, 80]</th>
      <td>28.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>24.0</td>
      <td>1.0</td>
      <td>28.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>(80, 90]</th>
      <td>19.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>1.0</td>
      <td>29.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">United States</th>
      <th>(20, 30]</th>
      <td>21.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>16.0</td>
      <td>1.0</td>
      <td>21.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>(30, 40]</th>
      <td>21.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>26.0</td>
      <td>1.0</td>
      <td>41.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>(40, 50]</th>
      <td>23.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>30.0</td>
      <td>1.0</td>
      <td>31.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>(50, 60]</th>
      <td>27.0</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>25.0</td>
      <td>1.0</td>
      <td>40.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>(60, 70]</th>
      <td>17.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>2.0</td>
      <td>26.0</td>
      <td>2.0</td>
      <td>39.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>(70, 80]</th>
      <td>22.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>18.0</td>
      <td>5.0</td>
      <td>61.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>(80, 90]</th>
      <td>24.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>15.0</td>
      <td>3.0</td>
      <td>39.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>The End&hellip;</p>


        
          <div class="blog-tags">
            
              <a href="https://adelr.github.io//tags/python/">python</a>&nbsp;
            
              <a href="https://adelr.github.io//tags/pandas/">pandas</a>&nbsp;
            
              <a href="https://adelr.github.io//tags/groupby/">groupby</a>&nbsp;
            
              <a href="https://adelr.github.io//tags/data-wrangling/">data wrangling</a>&nbsp;
            
          </div>
        

        
            <hr/>
            <section id="social-share">
              <div class="list-inline footer-links">
                

<div class="share-box" aria-hidden="true">
    <ul class="share">
      
      <li>
        <a href="//twitter.com/share?url=https%3a%2f%2fadelr.github.io%2f2018%2f11%2fpandas_groupby%2f&amp;text=Pandas%20%28Blood%29groupby&amp;via=DinkumData" target="_blank" title="Share on Twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//plus.google.com/share?url=https%3a%2f%2fadelr.github.io%2f2018%2f11%2fpandas_groupby%2f" target="_blank" title="Share on Google Plus">
          <i class="fab fa-google-plus"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fadelr.github.io%2f2018%2f11%2fpandas_groupby%2f" target="_blank" title="Share on Facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//reddit.com/submit?url=https%3a%2f%2fadelr.github.io%2f2018%2f11%2fpandas_groupby%2f&amp;title=Pandas%20%28Blood%29groupby" target="_blank" title="Share on Reddit">
          <i class="fab fa-reddit"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fadelr.github.io%2f2018%2f11%2fpandas_groupby%2f&amp;title=Pandas%20%28Blood%29groupby" target="_blank" title="Share on LinkedIn">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fadelr.github.io%2f2018%2f11%2fpandas_groupby%2f&amp;title=Pandas%20%28Blood%29groupby" target="_blank" title="Share on StumbleUpon">
          <i class="fab fa-stumbleupon"></i>
        </a>
      </li>
  
      
      <li>
        <a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fadelr.github.io%2f2018%2f11%2fpandas_groupby%2f&amp;description=Pandas%20%28Blood%29groupby" target="_blank" title="Share on Pinterest">
          <i class="fab fa-pinterest"></i>
        </a>
      </li>
    </ul>
  </div>
  
              </div>
            </section>
        

        
          
          
          <h4 class="see-also">See also</h4>
          <ul>
          
            <li><a href="/2018/10/unicode_intro/">Unicode strings in Python</a></li>
          
            <li><a href="/2018/08/simul_t_test/">That ain&#39;t dancing Sally!</a></li>
          
            <li><a href="/2018/06/simul_birthday/">Happy birthday to you!</a></li>
          
          </ul>
          
        
      </article>

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="https://adelr.github.io/2018/10/unicode_intro/" data-toggle="tooltip" data-placement="top" title="Unicode strings in Python">&larr; Previous Post</a>
            </li>
          
          
            <li class="next">
              <a href="https://adelr.github.io/2019/01/regex_intro/" data-toggle="tooltip" data-placement="top" title="Introduction to regular expressions">Next Post &rarr;</a>
            </li>
          
        </ul>
      


      
        
        
      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:dinkumdata@gmail.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/adelr" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/DinkumData" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              Adel Rahmani
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2019
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://adelr.github.io/">Dinkum Data Blog</a>
          
          &nbsp;&bull;&nbsp;
          The text is released under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative
            Commons Attribution 4.0 International License</a>, and the code is released under the <a
            href="https://opensource.org/licenses/MIT">MIT license</a>
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.55.6</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="https://adelr.github.io/js/main.js"></script>
<script src="https://adelr.github.io/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script> renderMathInElement(document.body); </script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="https://adelr.github.io/js/load-photoswipe.js"></script>









  </body>
</html>

